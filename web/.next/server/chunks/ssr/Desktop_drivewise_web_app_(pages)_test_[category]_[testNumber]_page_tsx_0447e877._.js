module.exports=[6934,a=>{"use strict";var b=a.i(681),c=a.i(84813),d=a.i(10317),e=a.i(90007),f=a.i(93639),g=a.i(663),h=a.i(63875),i=a.i(92347),j=a.i(28231),k=a.i(1004),l=a.i(40591),m=a.i(94902),n=a.i(46667),o=a.i(70604),p=a.i(46456),q=a.i(53365),r=a.i(25761),s=a.i(37979),t=a.i(61334),u=a.i(81217),v=a.i(22309),w=a.i(66355);let x=(0,d.default)(async()=>{},{loadableGenerated:{modules:[30918]},ssr:!1}),y=(0,r.createClient)();function z(){var a,d;let r,z=(0,q.useParams)(),A=(0,q.useRouter)(),B=(0,s.useQueryClient)(),{t:C,language:D}=(0,u.useLanguage)(),G=z.category.toUpperCase(),H=z.testNumber,I="mixed"===H,J="personalized"===H,[K,L]=(0,c.useState)(0),[M,N]=(0,c.useState)({}),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)(!0),[U,V]=(0,c.useState)(null),[W,X]=(0,c.useState)(Date.now()),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),{user:aa,isAdmin:ab,loading:ac}=(0,v.useAuth)(),{data:ad}=(0,w.useCategoryEntitlements)(aa?.id,G,ab);(0,c.useEffect)(()=>{ac||(aa?(async()=>{try{V(aa.id),X(Date.now());let a=`test_progress_${aa.id}_${G}_${H}`,b=localStorage.getItem(a);if(b)try{let a=JSON.parse(b);if(Date.now()-a.timestamp<864e5){R(a.questions),N(a.answers),L(a.currentQuestion),X(a.startTime||Date.now()),T(!1);return}}catch(b){localStorage.removeItem(a)}let c=await E({supabase:y,userId:aa.id,category:G,testNumber:H});R(c)}catch(a){t.toast.error(C("test.loadError"))}finally{T(!1)}})():A.push("/login"))},[ac,aa,G,H,A]),(0,c.useEffect)(()=>{if(!U||0===Q.length||O)return;let a=`test_progress_${U}_${G}_${H}`,b={questions:Q,answers:M,currentQuestion:K,startTime:W,timestamp:Date.now()};localStorage.setItem(a,JSON.stringify(b))},[U,G,H,Q,M,K,W,O]);let ae=j.CATEGORY_INFO[G],af=Q.length,ag=af>0?(K+1)/af*100:0,ah=Q.reduce((a,b)=>{let c=M[b.id];return c&&c.length>0?a+1:a},0),ai=af>0&&ah===af,aj=async a=>{if(a.preventDefault(),U)try{let a=F(Q,M),b=Math.floor((Date.now()-W)/1e3),{data:c,error:d}=await y.from("user_profiles").select("id").eq("id",U).maybeSingle();if(!c)if(aa){let{error:a}=await y.from("user_profiles").insert({id:aa.id,email:aa.email||"",full_name:aa.user_metadata?.full_name||aa.email?.split("@")[0]||"User"}).select().single();if(a){t.toast.error(C("test.createProfileError")),P(!0);return}}else{t.toast.error(C("auth.loginAgain")),A.push("/login");return}let{data:e,error:f}=await y.from("test_attempts").insert({user_id:U,category:G,test_number:H,score:a.correct,total_questions:a.total,percentage:a.percentage,time_taken_seconds:b,completed_at:new Date().toISOString()}).select().single();if(f){t.toast.error(C("test.saveError")),P(!0);return}_(e.id),B.invalidateQueries({queryKey:["user-test-stats",U]}),B.invalidateQueries({queryKey:["dashboard-stats",U]});let{count:g}=await y.from("test_attempts").select("*",{count:"exact",head:!0}).eq("user_id",U),{data:h}=await y.from("user_profiles").select("app_rating").eq("id",U).single(),i=1===g&&!h?.app_rating;if(e){let a=Q.map(a=>{let b=M[a.id]||[],c=a.correct_answers&&a.correct_answers.length>0?a.correct_answers:[a.correct_answer],d=b.length===c.length&&b.every(a=>c.includes(a)),f=b.length>0?b.join(","):null;return{test_attempt_id:e.id,question_id:a.id,selected_answer:f,is_correct:d}}),{error:b}=await y.from("test_attempt_answers").insert(a).select();b&&t.toast.error(C("test.saveDetailsError"))}let j=`test_progress_${U}_${G}_${H}`;localStorage.removeItem(j),P(!0),i&&setTimeout(()=>{Z(!0)},1500)}catch(a){t.toast.error(C("test.unexpectedError")),P(!0)}},ak=F(Q,M),al=O?(a=Q,d=M,r={},a.forEach(a=>{let b=a.topic;if(!b)return;r[b]||(r[b]={total:0,correct:0});let c=d[a.id]||[],e=a.correct_answers&&a.correct_answers.length>0?a.correct_answers:[a.correct_answer],f=c.length===e.length&&c.every(a=>e.includes(a));r[b].total+=1,f&&(r[b].correct+=1)}),Object.entries(r).map(([a,b])=>{let c=b.total>0?b.correct/b.total:0;return{topic:a,total:b.total,correct:b.correct,accuracy:c}}).sort((a,b)=>a.accuracy-b.accuracy).filter(a=>a.total>=2&&a.accuracy<.8).slice(0,3)):[];if(ac||!aa)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:(0,b.jsxs)(e.Card,{className:"max-w-md w-full border border-border/80 bg-card/95 backdrop-blur-xl",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Loading"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:ac?"Authenticating...":"Redirecting..."})]})})]})});if(S)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:(0,b.jsxs)(e.Card,{className:"max-w-3xl w-full mx-auto border-primary/20 bg-card/95 backdrop-blur-xl shadow-xl shadow-primary/5",children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(i.Skeleton,{className:"h-4 w-32 mb-3"}),(0,b.jsx)(i.Skeleton,{className:"h-8 w-3/4"})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsx)(i.Skeleton,{className:"h-48 w-full rounded-xl"}),(0,b.jsx)("div",{className:"space-y-3",children:Array.from({length:3}).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.Skeleton,{className:"h-5 w-5 rounded-md"}),(0,b.jsx)(i.Skeleton,{className:"h-4 flex-1"})]},c))}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(i.Skeleton,{className:"h-10 flex-1"}),(0,b.jsx)(i.Skeleton,{className:"h-10 flex-1"})]})]})]})});if(0===Q.length)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsxs)(e.Card,{className:"max-w-md",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:C("test.noQuestionsTitle")})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:C("test.noQuestionsDescription")}),(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsx)(k.default,{href:`/category/${G.toLowerCase()}`,children:C("test.backToTests")})})]})]})});if(!ab&&ad&&!ad.entitlements.canStartNewTest&&!O){let a=ad.testsTakenThisCycle,c=ad.entitlements.remainingFreeTests??0;return(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-72 bg-gradient-to-b from-orange-500/20 via-transparent to-transparent blur-3xl"}),(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,b.jsxs)(f.GlassCard,{className:"w-full max-w-2xl p-8 md:p-10 border border-orange-500/30 bg-black/85 text-center relative overflow-hidden",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute -top-24 -right-24 w-64 h-64 bg-orange-500/10 rounded-full blur-3xl"}),(0,b.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-orange-500/10 flex items-center justify-center mb-6 border border-orange-500/20",children:(0,b.jsx)(p.Lock,{className:"w-8 h-8 text-orange-400"})}),(0,b.jsx)("h1",{className:"text-3xl font-semibold mb-3 tracking-tight",children:C("test.limitReachedTitle")||"Free test limit reached"}),(0,b.jsx)("p",{className:"text-base text-muted-foreground mb-8 max-w-lg mx-auto leading-relaxed",children:C("test.limitReachedDescription")||`You have used ${a}/${a+c} free tests for ${j.CATEGORY_INFO[G].name} this cycle.`}),(0,b.jsx)("div",{className:"grid gap-4 text-left max-w-md mx-auto mb-8 w-full",children:[C("test.unlimitedTestsBenefit"),C("test.fullReviewBenefit"),C("test.trainerUnlockedBenefit")].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsx)("div",{className:"mt-0.5 w-5 h-5 rounded-full bg-orange-500/20 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-orange-400"})}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a})]},c))}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-sm",children:[(0,b.jsx)(g.Button,{asChild:!0,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-black font-medium h-11",children:(0,b.jsx)(k.default,{href:`/pricing?category=${G}`,children:C("test.upgradeCta")||"See plans"})}),(0,b.jsx)(g.Button,{asChild:!0,variant:"outline",className:"flex-1 h-11 border-white/10 hover:bg-white/5",children:(0,b.jsx)(k.default,{href:`/category/${G.toLowerCase()}`,children:C("test.backToTests")})})]})]})]})})]})}if(O){let a=ak.percentage>=80;return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("header",{className:"border-b border-border/40 bg-card/50 backdrop-blur-sm",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,b.jsx)(g.Button,{variant:"ghost",asChild:!0,children:(0,b.jsxs)(k.default,{href:`/category/${G.toLowerCase()}`,children:[(0,b.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),C("test.backToTests")]})})})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,b.jsxs)(e.Card,{className:"max-w-2xl mx-auto border border-border/80 bg-black/80 backdrop-blur-xl shadow-[0_30px_100px_rgba(0,0,0,0.9)]",children:[(0,b.jsxs)(e.CardHeader,{className:"text-center space-y-6",children:[(0,b.jsxs)("div",{className:"relative mx-auto w-24 h-24",children:[(0,b.jsx)("div",{className:`absolute inset-0 blur-2xl rounded-full ${a?"bg-primary/30":"bg-destructive/30"}`}),(0,b.jsx)("div",{className:`relative w-24 h-24 rounded-2xl flex items-center justify-center ${a?"bg-gradient-to-br from-primary/20 to-primary/10 border-2 border-primary/30":"bg-gradient-to-br from-destructive/20 to-destructive/10 border-2 border-destructive/30"}`,children:(0,b.jsx)(n.CheckCircle,{className:`w-14 h-14 ${a?"text-primary":"text-destructive"}`})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{className:"text-4xl font-bold mb-2",children:a?C("test.congratulations"):C("test.keepPracticing")}),(0,b.jsxs)("p",{className:"text-muted-foreground text-lg",children:[ae.name," -"," ","mixed"===H?C("test.mixedName"):"personalized"===H?C("test.personalizedName"):`${C("test.test")} ${H}`]})]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:`text-7xl font-bold mb-3 ${a?"text-primary":"text-destructive"}`,children:[ak.percentage,"%"]}),(0,b.jsxs)("p",{className:"text-muted-foreground text-lg",children:[ak.correct," ",C("test.of")," ",ak.total," ",C("test.correctAnswers")]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm font-medium",children:[(0,b.jsxs)("span",{children:[C("test.passingScore"),": 80%"]}),(0,b.jsx)("span",{className:a?"text-primary":"text-destructive",children:a?`✓ ${C("test.passed")}`:`✗ ${C("test.failed")}`})]}),(0,b.jsx)("div",{className:"w-full bg-secondary rounded-full h-3 overflow-hidden",children:(0,b.jsx)("div",{className:`h-3 rounded-full transition-all ${a?"bg-gradient-to-r from-primary to-primary/80":"bg-gradient-to-r from-destructive to-destructive/80"}`,style:{width:`${ak.percentage}%`}})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/40",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold mb-1",children:C("test.nextStepsTitle")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a?I||J?C("test.nextStepsPassedMixedOrPersonalized"):C("test.nextStepsPassedStandard"):J?C("test.nextStepsFailedPersonalized"):C("test.nextStepsFailedStandard")}),al.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("p",{className:"text-xs text-amber-500 mt-2",children:[C("test.weakTopicsInThisTest"),": ",al.map((a,c)=>(0,b.jsxs)("span",{children:[c>0&&", ",a.topic]},a.topic))]}),(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:al.map(a=>{let c=encodeURIComponent(a.topic);return(0,b.jsx)(g.Button,{size:"sm",variant:"outline",className:"text-xs px-3 py-1",asChild:!0,children:(0,b.jsx)(k.default,{href:`/materials?search=${c}`,children:C("materials.title")})},a.topic)})})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(k.default,{href:`/category/${G.toLowerCase()}`,children:C("test.backToTests")})}),$&&(0,b.jsx)(g.Button,{className:"flex-1",variant:"secondary",asChild:!0,children:(0,b.jsx)(k.default,{href:`/history/${$}`,children:C("test.reviewTest")})}),(0,b.jsx)(g.Button,{className:"flex-1",onClick:async()=>{if(U)try{T(!0),P(!1),N({}),L(0),_(null),Z(!1),X(Date.now());let a=await E({supabase:y,userId:U,category:G,testNumber:H});R(a)}catch(a){t.toast.error("Could not restart test. Please try again.")}finally{T(!1)}},children:C("test.retakeTest")})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[!J&&(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(k.default,{href:`/test/${G.toLowerCase()}/personalized`,children:C("test.practiceWeakPointsCta")})}),!I&&(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(k.default,{href:`/test/${G.toLowerCase()}/mixed`,children:C("test.mixedTestCta")})}),(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(k.default,{href:"/decision-trainer",children:C("test.decisionTrainerCta")})})]})]})]})]})}),U&&(0,b.jsx)(x,{open:Y,onClose:()=>Z(!1),userId:U})]})}let am=Q[K];if(!am)return(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:(0,b.jsxs)(e.Card,{className:"max-w-md w-full border border-border/80 bg-card/95 backdrop-blur-xl",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:C("test.noQuestionsTitle")})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:C("test.noQuestionsDescription")}),(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsx)(k.default,{href:`/category/${G.toLowerCase()}`,children:C("test.backToTests")})})]})]})});let an=am.question_text,ao=M[am.id]||[],ap=am.topic?encodeURIComponent(am.topic):"",aq=[{id:"A",text:am.option_a},{id:"B",text:am.option_b},{id:"C",text:am.option_c}];return(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("header",{className:"border-b border-border/40 bg-card/50 backdrop-blur-sm sticky top-0 z-50",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)(g.Button,{variant:"ghost",asChild:!0,size:"sm",children:(0,b.jsxs)(k.default,{href:`/category/${G.toLowerCase()}`,children:[(0,b.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),C("test.exitTest")]})}),(0,b.jsxs)("div",{className:"text-sm font-semibold px-4 py-2 rounded-full bg-primary/10 border border-primary/20 text-primary",children:[C("test.question")," ",K+1," ",C("test.of")," ",af]})]}),(0,b.jsx)("div",{className:"w-full bg-secondary rounded-full h-2 overflow-hidden",children:(0,b.jsx)("div",{className:"bg-gradient-to-r from-primary to-primary/80 h-2 rounded-full transition-all duration-300",style:{width:`${ag}%`}})})]})}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)(e.Card,{className:`${am.image_url?"max-w-6xl":"max-w-3xl"} mx-auto border border-border/80 bg-black/80 backdrop-blur-xl shadow-[0_24px_80px_rgba(0,0,0,0.85)]`,children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"text-sm text-primary font-medium mb-3",children:[ae.name," -"," ","mixed"===H?C("test.mixedName"):"personalized"===H?C("test.personalizedName"):`${C("test.test")} ${H}`]}),(0,b.jsx)(e.CardTitle,{className:"text-2xl md:text-3xl",children:an}),am.topic&&ap&&(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:am.topic}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",className:"h-7 px-2 text-[11px]",asChild:!0,children:(0,b.jsx)(k.default,{href:`/materials?search=${ap}`,children:C("materials.title")})})]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:am.image_url?"grid grid-cols-1 lg:grid-cols-2 gap-6":"",children:[am.image_url&&(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("div",{className:"relative rounded-xl overflow-hidden border-2 border-border shadow-lg",children:(0,b.jsx)("img",{src:am.image_url,alt:C("test.questionIllustration"),className:"w-full h-auto object-contain bg-muted/30",style:{maxHeight:"400px"}})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-2",children:C("test.questionImage")})]}),(0,b.jsx)("div",{className:"flex flex-col justify-center",children:(0,b.jsx)("div",{className:"space-y-3",children:aq.map(a=>{let c=ao.includes(a.id);return(0,b.jsxs)("div",{className:`flex items-center gap-3 p-4 md:p-5 rounded-xl border transition-colors cursor-pointer ${c?"border-primary/70 bg-primary/10 shadow-[0_18px_50px_rgba(0,0,0,0.9)]":"border-border/70 bg-black/60 hover:border-primary/50 hover:bg-black/80"}`,onClick:()=>(a=>{if(0===Q.length)return;let b=Q[K],c=M[b.id]||[],d=c.includes(a)?c.filter(b=>b!==a):[...c,a];N({...M,[b.id]:d})})(a.id),children:[(0,b.jsx)("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center ${c?"border-primary bg-primary text-primary-foreground":"border-border bg-black/60"}`,children:c&&(0,b.jsx)(o.CheckSquare,{className:"w-3.5 h-3.5"})}),(0,b.jsxs)(h.Label,{className:"cursor-pointer flex-1 font-medium",children:[(0,b.jsxs)("span",{className:"font-semibold mr-2",children:[a.id,"."]}),a.text]})]},a.id)})})})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>{K>0&&L(a=>a-1)},disabled:0===K,className:"flex-1",children:[(0,b.jsx)(l.ArrowLeft,{className:"w-4 h-4 mr-2"}),C("test.previous")]}),K===af-1?(0,b.jsxs)(g.Button,{onClick:aj,disabled:!ai,className:"flex-1",children:[C("test.submitTest"),(0,b.jsx)(n.CheckCircle,{className:"w-4 h-4 ml-2"})]}):(0,b.jsxs)(g.Button,{onClick:()=>{K<af-1&&L(a=>a+1)},disabled:0===ao.length,className:"flex-1",children:[C("test.next"),(0,b.jsx)(m.ArrowRight,{className:"w-4 h-4 ml-2"})]})]}),(0,b.jsxs)("div",{className:"border-t pt-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[C("test.question")," ",K+1," ",C("test.of")," ",af]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${ao.length>0?"bg-primary":"bg-secondary"}`}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ah,"/",af," ",C("test.answeredLabel")]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>L(Math.max(0,K-5)),disabled:0===K,className:"p-1 rounded hover:bg-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:(0,b.jsx)(l.ArrowLeft,{className:"w-3 h-3"})}),(0,b.jsx)("div",{className:"flex-1 overflow-x-auto scrollbar-hide",children:(0,b.jsx)("div",{className:"flex gap-1",children:Q.map((a,c)=>{let d=Math.abs(c-K);if(d>4&&0!==c&&c!==af-1)return null;if(5===d)return(0,b.jsx)("span",{className:"px-1 text-xs text-muted-foreground",children:"..."},`ellipsis-${c}`);let e=M[a.id]&&M[a.id].length>0;return(0,b.jsx)("button",{onClick:()=>L(c),className:`min-w-[28px] h-7 px-2 rounded text-xs font-medium transition-colors whitespace-nowrap ${c===K?"bg-primary text-primary-foreground":e?"bg-primary/20 text-primary":"bg-secondary hover:bg-secondary/80"}`,children:c+1},a.id)})})}),(0,b.jsx)("button",{onClick:()=>L(Math.min(af-1,K+5)),disabled:K===af-1,className:"p-1 rounded hover:bg-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:(0,b.jsx)(m.ArrowRight,{className:"w-3 h-3"})})]})]})]})]})})]})}function A(a){return[...a].sort(()=>.5-Math.random())}async function B({supabase:a,userId:b,category:c}){let{data:d,error:e}=await a.from("test_attempts").select("id").eq("user_id",b).eq("category",c);if(e)throw Error(`Error fetching test attempts: ${e.message}`);let f=d?.map(a=>a.id)||[];if(0===f.length)return[];let{data:g,error:h}=await a.from("test_attempt_answers").select("question_id").eq("is_correct",!1).in("test_attempt_id",f);if(h)throw Error(`Error fetching wrong answers: ${h.message}`);let i=[...new Set(g?.map(a=>a.question_id)||[])];if(0===i.length)return[];let{data:j,error:k}=await a.from("admin_questions").select("*").in("id",i).eq("category",c);if(k)throw Error(`Error fetching questions: ${k.message}`);let l=j||[];if(l.length<10){let{data:b}=await a.from("admin_questions").select("*").eq("category",c);if(b&&b.length>0){let a=new Set(l.map(a=>a.id)),c=A(b.filter(b=>!a.has(b.id))),d=10-l.length;l=[...l,...c.slice(0,Math.max(0,d))]}}return A(l).slice(0,10)}async function C({supabase:a,category:b}){let{data:c,error:d}=await a.from("admin_questions").select("*").eq("category",b);if(d)throw Error(`Error fetching mixed questions: ${d.message}`);if(!c||0===c.length)return[];let e=A(c);return e.slice(0,Math.min(10,e.length))}async function D({supabase:a,category:b,testNumber:c}){let d=parseInt(c,10);if(Number.isNaN(d))throw Error("Invalid test number");let{data:e,error:f}=await a.from("admin_questions").select("*").eq("category",b).eq("test_number",d);if(f)throw Error(`Error fetching fixed test questions: ${f.message}`);return e&&0!==e.length?e:[]}async function E({supabase:a,userId:b,category:c,testNumber:d}){if("personalized"===d){let d=await B({supabase:a,userId:b,category:c});return d.length>0?d:C({supabase:a,category:c})}return"mixed"===d?C({supabase:a,category:c}):D({supabase:a,category:c,testNumber:d})}function F(a,b){let c=a.length,d=0;return a.forEach(a=>{let c=b[a.id]||[],e=a.correct_answers&&a.correct_answers.length>0?a.correct_answers:[a.correct_answer];c.length===e.length&&c.every(a=>e.includes(a))&&(d+=1)}),{correct:d,total:c,percentage:c>0?Math.round(d/c*100):0}}a.s(["default",()=>z])}];

//# sourceMappingURL=Desktop_drivewise_web_app_%28pages%29_test_%5Bcategory%5D_%5BtestNumber%5D_page_tsx_0447e877._.js.map