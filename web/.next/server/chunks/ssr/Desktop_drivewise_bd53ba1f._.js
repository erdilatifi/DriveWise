module.exports=[64,a=>{"use strict";let b=(0,a.i(2017).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],64)},10226,a=>{"use strict";let b=(0,a.i(2017).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],10226)},70805,a=>{"use strict";let b=(0,a.i(2017).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],70805)},97684,a=>{"use strict";let b=(0,a.i(2017).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],97684)},28248,a=>{"use strict";let b=(0,a.i(2017).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);a.s(["Image",()=>b],28248)},24790,a=>{"use strict";let b=(0,a.i(2017).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],24790)},64392,a=>{"use strict";var b=a.i(60854),c=a.i(20416),d=a.i(37979),e=a.i(25761);function f(a={}){let{category:c,search:d,page:g=1,pageSize:h=50}=a,i=(0,e.createClient)();return(0,b.useQuery)({queryKey:["traffic-signs",c,d,g,h],queryFn:async()=>{let a=i.from("traffic_signs").select("*",{count:"planned"}).order("code",{ascending:!0});c&&"all"!==c&&(a=a.eq("category",c)),d&&(a=a.or(`name.ilike.%${d}%,code.ilike.%${d}%`));let b=(g-1)*h,{data:e,error:f,count:j}=await a.range(b,b+h-1);if(f)throw f;return{signs:(e||[]).map(a=>{if(a.image_url&&!a.image_url.startsWith("http")){let{data:{publicUrl:b}}=i.storage.from("signs").getPublicUrl(a.image_url);return{...a,image_url:b}}return a}),total:j||0}}})}function g(){let a=(0,d.useQueryClient)(),b=(0,e.createClient)();return(0,c.useMutation)({mutationFn:async({id:a,...c})=>{let{data:d,error:e}=await b.from("traffic_signs").update(c).eq("id",a).select().single();if(e)throw e;return d},onSuccess:()=>{a.invalidateQueries({queryKey:["traffic-signs"]})}})}function h(){let a=(0,d.useQueryClient)(),b=(0,e.createClient)();return(0,c.useMutation)({mutationFn:async a=>{let{error:c}=await b.from("traffic_signs").delete().eq("id",a);if(c)throw c;return a},onSuccess:()=>{a.invalidateQueries({queryKey:["traffic-signs"]})}})}function i(){let a=(0,e.createClient)();return(0,c.useMutation)({mutationFn:async b=>{let c=b.name.split(".").pop()||"png",d=`${Date.now()}-${Math.random().toString(36).slice(2)}`,e=`signs/${d}.${c}`,{error:f}=await a.storage.from("signs").upload(e,b,{cacheControl:"3600",upsert:!1});if(f)throw f;let{data:{publicUrl:g}}=a.storage.from("signs").getPublicUrl(e);return g}})}a.s(["useDeleteTrafficSign",()=>h,"useTrafficSigns",()=>f,"useUpdateTrafficSign",()=>g,"useUploadSignImage",()=>i])},20826,a=>{"use strict";var b=a.i(681),c=a.i(84813),d=a.i(53365),e=a.i(22309),f=a.i(81217),g=a.i(78330),h=a.i(34213),i=a.i(663),j=a.i(1004),k=a.i(40591),l=a.i(70805),m=a.i(24790),n=a.i(10226),o=a.i(64),p=a.i(26464),q=a.i(28248),r=a.i(97684),s=a.i(64392),t=a.i(93639),u=a.i(61334);function v(){let{user:a,isAdmin:v,loading:w}=(0,e.useAuth)(),{t:x}=(0,f.useLanguage)(),y=(0,d.useRouter)(),[z,A]=(0,c.useState)(1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)("all"),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),{data:J,isLoading:K,refetch:L}=(0,s.useTrafficSigns)({page:z,search:B,category:D,pageSize:50}),M=(0,s.useUpdateTrafficSign)(),N=(0,s.useDeleteTrafficSign)(),O=(0,s.useUploadSignImage)();(0,c.useEffect)(()=>{w||a&&v||y.push("/")},[a,v,w,y]);let P=async a=>{if(F){I(!0);try{let b=await O.mutateAsync(a);G({...F,image_url:b}),u.toast.success("Image uploaded successfully")}catch(a){u.toast.error("Failed to upload image")}finally{I(!1)}}},Q=async()=>{if(F)try{await M.mutateAsync({id:F.id,name:F.name,description:F.description,image_url:F.image_url}),u.toast.success("Sign updated successfully"),G(null),L()}catch(a){u.toast.error("Failed to update sign")}},R=async a=>{if(confirm("Are you sure you want to delete this sign?"))try{await N.mutateAsync(a),u.toast.success("Sign deleted successfully"),L()}catch(a){u.toast.error("Failed to delete sign")}};return!w&&a&&v?(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)(g.Navbar,{}),(0,b.jsxs)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,b.jsx)(i.Button,{variant:"ghost",asChild:!0,className:"pl-0 hover:bg-transparent hover:text-primary",children:(0,b.jsxs)(j.default,{href:"/admin",className:"flex items-center gap-2",children:[(0,b.jsx)(k.ArrowLeft,{className:"w-4 h-4"}),x("admin.backToDashboard")]})})}),(0,b.jsxs)(h.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:x("admin.trafficSigns")}),(0,b.jsx)("p",{className:"text-muted-foreground",children:x("admin.trafficSignsDesc")})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,b.jsx)("input",{type:"text",placeholder:"Search by name or code...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-border bg-card/50 focus:outline-none focus:border-primary",value:B,onChange:a=>C(a.target.value)})]}),(0,b.jsxs)("select",{className:"px-4 py-2 rounded-lg border border-border bg-card/50 focus:outline-none focus:border-primary",value:D,onChange:a=>E(a.target.value),children:[(0,b.jsx)("option",{value:"all",children:"All Categories"}),(0,b.jsx)("option",{value:"danger",children:"Danger"}),(0,b.jsx)("option",{value:"prohibition",children:"Prohibition"}),(0,b.jsx)("option",{value:"mandatory",children:"Mandatory"}),(0,b.jsx)("option",{value:"info",children:"Info"})]})]}),K?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(r.Loader2,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-primary"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading signs..."})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J?.signs.map(a=>(0,b.jsx)(t.GlassCard,{className:"p-4 flex flex-col h-full bg-black/40 border-border/50",children:F?.id===a.id?(0,b.jsxs)("div",{className:"space-y-4 flex-1",children:[(0,b.jsxs)("div",{className:"relative aspect-video bg-black/20 rounded-lg overflow-hidden flex items-center justify-center group border-2 border-dashed border-border/50",children:[F.image_url?(0,b.jsx)("img",{src:F.image_url,alt:a.name,className:"w-full h-full object-contain"}):(0,b.jsx)(q.Image,{className:"w-8 h-8 text-muted-foreground"}),(0,b.jsxs)("label",{className:"absolute inset-0 flex items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 cursor-pointer transition-opacity",children:[(0,b.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:a=>a.target.files?.[0]&&P(a.target.files[0])}),(0,b.jsxs)("div",{className:"text-white flex flex-col items-center",children:[(0,b.jsx)(m.Upload,{className:"w-6 h-6 mb-2"}),(0,b.jsx)("span",{className:"text-xs",children:"Change Image"})]})]}),H&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",children:(0,b.jsx)(r.Loader2,{className:"w-6 h-6 animate-spin text-white"})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Name"}),(0,b.jsx)("input",{value:F.name,onChange:a=>G({...F,name:a.target.value}),className:"w-full px-3 py-2 rounded bg-black/20 border border-border focus:border-primary outline-none text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Description"}),(0,b.jsx)("textarea",{value:F.description,onChange:a=>G({...F,description:a.target.value}),className:"w-full px-3 py-2 rounded bg-black/20 border border-border focus:border-primary outline-none text-sm min-h-[80px]"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-2 mt-auto",children:[(0,b.jsxs)(i.Button,{size:"sm",onClick:Q,className:"flex-1",children:[(0,b.jsx)(o.Save,{className:"w-4 h-4 mr-2"}),"Save"]}),(0,b.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>G(null),children:(0,b.jsx)(p.X,{className:"w-4 h-4"})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"aspect-video bg-white/5 rounded-lg mb-4 p-2 flex items-center justify-center relative",children:[a.image_url?(0,b.jsx)("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-contain"}):(0,b.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,b.jsx)(q.Image,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("span",{className:"text-xs",children:"No image"})]}),(0,b.jsx)("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/60 backdrop-blur-sm rounded text-xs font-mono text-primary",children:a.code})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold mb-1 line-clamp-1",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4",children:a.description})]}),(0,b.jsxs)("div",{className:"flex gap-2 mt-auto pt-4 border-t border-border/30",children:[(0,b.jsx)(i.Button,{size:"sm",variant:"ghost",className:"flex-1 hover:bg-primary/10 hover:text-primary",onClick:()=>G(a),children:"Edit"}),(0,b.jsx)(i.Button,{size:"sm",variant:"ghost",className:"hover:bg-red-500/10 hover:text-red-500 text-muted-foreground",onClick:()=>R(a.id),children:(0,b.jsx)(n.Trash2,{className:"w-4 h-4"})})]})]})},a.id))}),J&&J.total>50&&(0,b.jsxs)("div",{className:"flex justify-center gap-2 mt-8",children:[(0,b.jsx)(i.Button,{variant:"outline",disabled:1===z,onClick:()=>A(a=>a-1),children:"Previous"}),(0,b.jsxs)("div",{className:"flex items-center px-4",children:["Page ",z," of ",Math.ceil(J.total/50)]}),(0,b.jsx)(i.Button,{variant:"outline",disabled:z>=Math.ceil(J.total/50),onClick:()=>A(a=>a+1),children:"Next"})]})]})]})]}):null}a.s(["default",()=>v])}];

//# sourceMappingURL=Desktop_drivewise_bd53ba1f._.js.map