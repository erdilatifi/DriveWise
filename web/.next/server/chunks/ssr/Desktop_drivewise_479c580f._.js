module.exports=[92347,a=>{"use strict";var b=a.i(681),c=a.i(46444);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("relative overflow-hidden rounded-xl bg-gradient-to-r from-muted/60 via-muted/35 to-muted/60","before:absolute before:inset-0 before:-translate-x-full before:bg-gradient-to-r before:from-transparent before:via-primary/18 before:to-transparent before:animate-[shimmer_1.4s_infinite]",a),...d})}a.s(["Skeleton",()=>d])},87454,a=>{"use strict";var b=a.i(681),c=a.i(84813),d=a.i(46444),e=a.i(663);let f=({open:a,onOpenChange:c,children:d})=>(0,b.jsx)(b.Fragment,{children:a&&(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-xl",onClick:()=>c?.(!1)}),(0,b.jsx)("div",{className:"relative z-50",children:d})]})}),g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-border/70 bg-card/90 p-6 shadow-[0_24px_80px_rgba(0,0,0,0.9)] backdrop-blur-2xl duration-200",a),...c}));g.displayName="AlertDialogContent";let h=({className:a,...c})=>(0,b.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...c});h.displayName="AlertDialogHeader";let i=({className:a,...c})=>(0,b.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...c});i.displayName="AlertDialogFooter";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h2",{ref:e,className:(0,d.cn)("text-lg font-semibold",a),...c}));j.displayName="AlertDialogTitle";let k=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));k.displayName="AlertDialogDescription";let l=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(e.Button,{ref:f,className:(0,d.cn)("",a),...c}));l.displayName="AlertDialogAction";let m=c.forwardRef(({className:a,...c},f)=>(0,b.jsx)(e.Button,{ref:f,variant:"outline",className:(0,d.cn)("mt-2 sm:mt-0",a),...c}));m.displayName="AlertDialogCancel",a.s(["AlertDialog",()=>f,"AlertDialogAction",()=>l,"AlertDialogCancel",()=>m,"AlertDialogContent",()=>g,"AlertDialogDescription",()=>k,"AlertDialogFooter",()=>i,"AlertDialogHeader",()=>h,"AlertDialogTitle",()=>j])},46667,a=>{"use strict";let b=(0,a.i(2017).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],46667)},96112,a=>{"use strict";let b=(0,a.i(2017).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],96112)},89796,a=>{"use strict";var b=a.i(60854),c=a.i(20416),d=a.i(37979),e=a.i(25761);function f(a){return(0,b.useQuery)({queryKey:["global-daily-streak",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("test_attempts").select("completed_at").eq("user_id",a);if(d)throw d;let{data:f,error:g}=await b.from("decision_trainer_attempts").select("created_at").eq("user_id",a);if(g)throw g;let h=[];(c||[]).forEach(a=>{let b=new Date(a.completed_at);h.push(new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime())}),(f||[]).forEach(a=>{let b=new Date(a.created_at);h.push(new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime())});let i=[...new Set(h)].sort((a,b)=>b-a);if(0===i.length)return{currentStreak:0,bestStreak:0};let j=new Date,k=new Date(j.getFullYear(),j.getMonth(),j.getDate()).getTime(),l=0,m=0;if(i[0]===k||i[0]===k-864e5){l=1,m=1;for(let a=1;a<i.length;a++){let b=i[a-1]-864e5;if(i[a]===b)++l>m&&(m=l);else break}}return{currentStreak:l,bestStreak:m}},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function g(a){return(0,b.useQuery)({queryKey:["dashboard-stats",a],queryFn:async()=>{let b=(0,e.createClient)();try{let[c,d,e,f]=await Promise.all([b.rpc("get_dashboard_stats",{p_user_id:a}),b.rpc("get_weekly_progress",{p_user_id:a}),b.rpc("get_recent_tests",{p_user_id:a,p_limit:4}),b.from("test_attempts").select("completed_at").eq("user_id",a).order("completed_at",{ascending:!1})]);if(c.error)throw c.error;if(d.error)throw d.error;if(e.error)throw e.error;let g=c.data?.[0]||{total_tests:0,average_score:0,best_score:0,tests_this_week:0,passed_tests:0,failed_tests:0},h=(f.data||[]).map(a=>{let b=new Date(a.completed_at);return new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()}),i=[...new Set(h)].sort((a,b)=>b-a),j=0,k=new Date,l=new Date(k.getFullYear(),k.getMonth(),k.getDate()).getTime();if(i.length>0&&(i[0]===l||i[0]===l-864e5)){j=1;for(let a=1;a<i.length;a++){let b=i[a-1]-864e5;if(i[a]===b)j++;else break}}let m=[],n=d.data||[];for(let a=6;a>=0;a--){let b=new Date;b.setDate(b.getDate()-a);let c=b.toISOString().split("T")[0],d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][b.getDay()],e=n.find(a=>a.attempt_date===c);m.push({date:d,score:e?e.daily_avg_score:0})}let o=(e.data||[]).map(a=>({id:a.id,category:a.category,testNumber:a.test_number||"1",score:Number(a.percentage),date:new Date(a.completed_at).toLocaleDateString(),passed:Number(a.percentage)>=80}));return{stats:{totalTests:g.total_tests,averageScore:g.average_score,bestScore:g.best_score,testsThisWeek:g.tests_this_week,streak:j,passedTests:g.passed_tests,failedTests:g.failed_tests},progressData:m,recentTests:o}}catch(a){return{stats:{totalTests:0,averageScore:0,bestScore:0,testsThisWeek:0,streak:0,passedTests:0,failedTests:0},progressData:[],recentTests:[]}}},enabled:!!a,staleTime:12e4})}function h(a,c=1,d=6){return(0,b.useQuery)({queryKey:["test-history",a,c,d],queryFn:async()=>{let b=(0,e.createClient)(),f=(c-1)*d,[g,h]=await Promise.all([b.from("test_attempts").select("*").eq("user_id",a).order("completed_at",{ascending:!1}).range(f,f+d-1),b.from("test_attempts").select("*",{count:"exact",head:!0}).eq("user_id",a)]);if(g.error)throw g.error;if(h.error)throw h.error;return{tests:g.data||[],totalCount:h.count||0,totalPages:Math.ceil((h.count||0)/d)}},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=(0,e.createClient)(),{error:c}=await b.from("test_attempts").delete().eq("id",a);if(c)throw c},onSuccess:()=>{a.invalidateQueries({queryKey:["test-attempts"]}),a.invalidateQueries({queryKey:["dashboard-stats"]}),a.invalidateQueries({queryKey:["test-history"]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=(0,e.createClient)(),{error:c}=await b.from("test_attempts").delete().eq("user_id",a);if(c)throw c},onSuccess:()=>{a.invalidateQueries({queryKey:["test-attempts"]}),a.invalidateQueries({queryKey:["dashboard-stats"]}),a.invalidateQueries({queryKey:["test-history"]})}})}function k(a,c=!0){return(0,b.useQuery)({queryKey:["test-count",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("admin_questions").select("test_number").eq("category",a);if(d)throw d;return[...new Set((c||[]).map(a=>a.test_number))].length},staleTime:6e5,enabled:c&&!!a})}function l(a){return(0,b.useQuery)({queryKey:["weak-topics",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("test_attempts").select("id").eq("user_id",a).order("completed_at",{ascending:!1}).limit(50);if(d)throw d;let f=(c||[]).map(a=>a.id);if(0===f.length)return{topics:[],weakTopics:[],dominantCategory:null};let{data:g,error:h}=await b.from("test_attempt_answers").select("question_id, is_correct").in("test_attempt_id",f);if(h)throw h;if(!g||0===g.length)return{topics:[],weakTopics:[],dominantCategory:null};let i=[...new Set(g.map(a=>a.question_id))],{data:j,error:k}=await b.from("admin_questions").select("id, topic, category").in("id",i);if(k)throw k;let l=new Map;(j||[]).forEach(a=>{l.set(a.id,{topic:a.topic??null,category:a.category??null})});let m={};g.forEach(a=>{let b=l.get(a.question_id);if(!b||!b.topic)return;let c=b.topic;m[c]||(m[c]={total:0,correct:0,category:b.category}),m[c].total+=1,a.is_correct&&(m[c].correct+=1)});let n=Object.entries(m).map(([a,b])=>{let c=b.total>0?b.correct/b.total:0;return{topic:a,totalQuestions:b.total,correct:b.correct,accuracy:c}}).sort((a,b)=>a.accuracy-b.accuracy),o=n.filter(a=>a.totalQuestions>=3&&a.accuracy<.8).slice(0,5),p={};o.forEach(a=>{let b=m[a.topic]?.category;b&&(p[b]=(p[b]||0)+1)});let q=null,r=0;if(Object.entries(p).forEach(([a,b])=>{b>r&&(r=b,q=a)}),!q&&n.length>0){let a={};Object.values(m).forEach(b=>{b.category&&(a[b.category]=(a[b.category]||0)+1)});let b=0;Object.entries(a).forEach(([a,c])=>{c>b&&(b=c,q=a)})}return{topics:n,weakTopics:o,dominantCategory:q}},enabled:!!a,staleTime:12e4})}a.s(["useClearAllTestAttempts",()=>j,"useDashboardStats",()=>g,"useDeleteTestAttempt",()=>i,"useGlobalDailyStreak",()=>f,"useTestCount",()=>k,"useTestHistory",()=>h,"useWeakTopics",()=>l])},91097,a=>{"use strict";let b=(0,a.i(2017).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);a.s(["default",()=>b])},39232,a=>{"use strict";var b=a.i(91097);a.s(["ChevronRight",()=>b.default])},10226,a=>{"use strict";let b=(0,a.i(2017).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],10226)},53669,a=>{"use strict";let b=(0,a.i(2017).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["default",()=>b])},93962,a=>{"use strict";var b=a.i(53669);a.s(["ChevronLeft",()=>b.default])}];

//# sourceMappingURL=Desktop_drivewise_479c580f._.js.map