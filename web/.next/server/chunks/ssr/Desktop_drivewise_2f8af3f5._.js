module.exports=[92347,a=>{"use strict";var b=a.i(681),c=a.i(46444);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("relative overflow-hidden rounded-xl bg-gradient-to-r from-muted/60 via-muted/35 to-muted/60","before:absolute before:inset-0 before:-translate-x-full before:bg-gradient-to-r before:from-transparent before:via-primary/18 before:to-transparent before:animate-[shimmer_1.4s_infinite]",a),...d})}a.s(["Skeleton",()=>d])},37322,a=>{"use strict";let b=(0,a.i(2017).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>b],37322)},28231,a=>{"use strict";a.s(["CATEGORY_INFO",0,{A:{name:"Kategoria A",description:"Motoçikleta"},B:{name:"Kategoria B",description:"Vetura"},C:{name:"Kategoria C",description:"Kamionë"},D:{name:"Kategoria D",description:"Autobusë"}}])},94902,a=>{"use strict";let b=(0,a.i(2017).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],94902)},9857,a=>{"use strict";let b=(0,a.i(2017).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);a.s(["TrendingUp",()=>b],9857)},33060,a=>{"use strict";let b=(0,a.i(2017).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>b],33060)},51933,a=>{"use strict";let b=(0,a.i(2017).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);a.s(["Trophy",()=>b],51933)},73080,a=>{"use strict";var b=a.i(60854),c=a.i(20416),d=a.i(37979),e=a.i(25761);function f(a,c){return(0,b.useQuery)({queryKey:["decision-trainer-progress",a,c],queryFn:async()=>{let b=(0,e.createClient)().from("decision_trainer_progress").select("*").eq("user_id",a);c&&(b=b.eq("category",c));let{data:d,error:f}=await b;if(f)throw f;return d||[]},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function g(a){return(0,b.useQuery)({queryKey:["decision-trainer-stats",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("decision_trainer_progress").select("*").eq("user_id",a);if(d)throw d;let f=c||[],g=f.reduce((a,b)=>a+b.total_xp,0),h=f.reduce((a,b)=>a+b.scenarios_completed,0),i=f.reduce((a,b)=>a+b.correct_answers,0),j=f.reduce((a,b)=>a+b.total_attempts,0),k=Math.max(...f.map(a=>a.best_streak),0),l=Math.min(...f.map(a=>a.best_time_seconds).filter(a=>null!==a),1/0),m=j>0?Math.round(i/j*100):0;return{totalXp:g,totalScenarios:h,totalCorrect:i,totalAttempts:j,bestStreak:k,bestTime:l===1/0?null:l,accuracy:m,categoriesCompleted:f.length,categoryProgress:f}},enabled:!!a,staleTime:6e4})}function h(a){return(0,b.useQuery)({queryKey:["weak-scenario-ids",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("decision_trainer_attempts").select("scenario_id, is_correct, created_at").eq("user_id",a).order("created_at",{ascending:!0});if(d)throw d;let f=new Map;(c||[]).forEach(a=>{f.set(a.scenario_id,a.is_correct)});let g=[];return f.forEach((a,b)=>{a||g.push(b)}),g},enabled:!!a,staleTime:0})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async({userId:a,category:b,attempts:c,totalTimeMs:d})=>{let f=(0,e.createClient)(),g=c.map(c=>({user_id:a,scenario_id:c.scenarioId,category:b,is_correct:c.isCorrect,selected_options:c.selectedOptions,time_taken_ms:c.timeTakenMs,xp_earned:c.xpEarned})),{error:h}=await f.from("decision_trainer_attempts").insert(g);if(h)throw h;let i=c.reduce((a,b)=>a+b.xpEarned,0),j=c.filter(a=>a.isCorrect).length,k=c.length,l=0,m=0;for(let a of c)a.isCorrect?l=Math.max(l,++m):m=0;let{data:n}=await f.from("decision_trainer_progress").select("*").eq("user_id",a).eq("category",b).maybeSingle(),o=(n?.total_xp||0)+i,p=(n?.scenarios_completed||0)+k,q=(n?.correct_answers||0)+j,r=(n?.total_attempts||0)+k,s=Math.max(n?.best_streak||0,l),t=Math.round(d/k/1e3),u=n?.best_time_seconds?Math.min(n.best_time_seconds,t):t,{data:v,error:w}=await f.from("decision_trainer_progress").upsert({user_id:a,category:b,total_xp:o,scenarios_completed:p,correct_answers:q,total_attempts:r,current_streak:l,best_streak:s,best_time_seconds:u,average_time_seconds:t,updated_at:new Date().toISOString()},{onConflict:"user_id,category"}).select().single();if(w)throw w;return{progress:v,sessionStats:{totalXpEarned:i,correctCount:j,totalCount:k,accuracy:Math.round(j/k*100),maxStreak:l,avgTimeSeconds:t}}},onSuccess:(b,c)=>{a.invalidateQueries({queryKey:["decision-trainer-progress",c.userId]}),a.invalidateQueries({queryKey:["decision-trainer-stats",c.userId]}),a.invalidateQueries({queryKey:["leaderboard"]})}})}a.s(["useCompleteCategory",()=>i,"useDecisionTrainerProgress",()=>f,"useDecisionTrainerStats",()=>g,"useWeakScenarioIds",()=>h])},89796,a=>{"use strict";var b=a.i(60854),c=a.i(20416),d=a.i(37979),e=a.i(25761);function f(a){return(0,b.useQuery)({queryKey:["global-daily-streak",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("test_attempts").select("completed_at").eq("user_id",a);if(d)throw d;let{data:f,error:g}=await b.from("decision_trainer_attempts").select("created_at").eq("user_id",a);if(g)throw g;let h=[];(c||[]).forEach(a=>{let b=new Date(a.completed_at);h.push(new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime())}),(f||[]).forEach(a=>{let b=new Date(a.created_at);h.push(new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime())});let i=[...new Set(h)].sort((a,b)=>b-a);if(0===i.length)return{currentStreak:0,bestStreak:0};let j=new Date,k=new Date(j.getFullYear(),j.getMonth(),j.getDate()).getTime(),l=0,m=0;if(i[0]===k||i[0]===k-864e5){l=1,m=1;for(let a=1;a<i.length;a++){let b=i[a-1]-864e5;if(i[a]===b)++l>m&&(m=l);else break}}return{currentStreak:l,bestStreak:m}},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function g(a){return(0,b.useQuery)({queryKey:["dashboard-stats",a],queryFn:async()=>{let b=(0,e.createClient)();try{let[c,d,e,f]=await Promise.all([b.rpc("get_dashboard_stats",{p_user_id:a}),b.rpc("get_weekly_progress",{p_user_id:a}),b.rpc("get_recent_tests",{p_user_id:a,p_limit:4}),b.from("test_attempts").select("completed_at").eq("user_id",a).order("completed_at",{ascending:!1})]);if(c.error)throw c.error;if(d.error)throw d.error;if(e.error)throw e.error;let g=c.data?.[0]||{total_tests:0,average_score:0,best_score:0,tests_this_week:0,passed_tests:0,failed_tests:0},h=(f.data||[]).map(a=>{let b=new Date(a.completed_at);return new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()}),i=[...new Set(h)].sort((a,b)=>b-a),j=0,k=new Date,l=new Date(k.getFullYear(),k.getMonth(),k.getDate()).getTime();if(i.length>0&&(i[0]===l||i[0]===l-864e5)){j=1;for(let a=1;a<i.length;a++){let b=i[a-1]-864e5;if(i[a]===b)j++;else break}}let m=[],n=d.data||[];for(let a=6;a>=0;a--){let b=new Date;b.setDate(b.getDate()-a);let c=b.toISOString().split("T")[0],d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][b.getDay()],e=n.find(a=>a.attempt_date===c);m.push({date:d,score:e?e.daily_avg_score:0})}let o=(e.data||[]).map(a=>({id:a.id,category:a.category,testNumber:a.test_number||"1",score:Number(a.percentage),date:new Date(a.completed_at).toLocaleDateString(),passed:Number(a.percentage)>=80}));return{stats:{totalTests:g.total_tests,averageScore:g.average_score,bestScore:g.best_score,testsThisWeek:g.tests_this_week,streak:j,passedTests:g.passed_tests,failedTests:g.failed_tests},progressData:m,recentTests:o}}catch(a){return{stats:{totalTests:0,averageScore:0,bestScore:0,testsThisWeek:0,streak:0,passedTests:0,failedTests:0},progressData:[],recentTests:[]}}},enabled:!!a,staleTime:12e4})}function h(a,c=1,d=6){return(0,b.useQuery)({queryKey:["test-history",a,c,d],queryFn:async()=>{let b=(0,e.createClient)(),f=(c-1)*d,[g,h]=await Promise.all([b.from("test_attempts").select("*").eq("user_id",a).order("completed_at",{ascending:!1}).range(f,f+d-1),b.from("test_attempts").select("*",{count:"exact",head:!0}).eq("user_id",a)]);if(g.error)throw g.error;if(h.error)throw h.error;return{tests:g.data||[],totalCount:h.count||0,totalPages:Math.ceil((h.count||0)/d)}},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=(0,e.createClient)(),{error:c}=await b.from("test_attempts").delete().eq("id",a);if(c)throw c},onSuccess:()=>{a.invalidateQueries({queryKey:["test-attempts"]}),a.invalidateQueries({queryKey:["dashboard-stats"]}),a.invalidateQueries({queryKey:["test-history"]})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=(0,e.createClient)(),{error:c}=await b.from("test_attempts").delete().eq("user_id",a);if(c)throw c},onSuccess:()=>{a.invalidateQueries({queryKey:["test-attempts"]}),a.invalidateQueries({queryKey:["dashboard-stats"]}),a.invalidateQueries({queryKey:["test-history"]})}})}function k(a,c=!0){return(0,b.useQuery)({queryKey:["test-count",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("admin_questions").select("test_number").eq("category",a);if(d)throw d;return[...new Set((c||[]).map(a=>a.test_number))].length},staleTime:6e5,enabled:c&&!!a})}function l(a){return(0,b.useQuery)({queryKey:["weak-topics",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("test_attempts").select("id").eq("user_id",a).order("completed_at",{ascending:!1}).limit(50);if(d)throw d;let f=(c||[]).map(a=>a.id);if(0===f.length)return{topics:[],weakTopics:[],dominantCategory:null};let{data:g,error:h}=await b.from("test_attempt_answers").select("question_id, is_correct").in("test_attempt_id",f);if(h)throw h;if(!g||0===g.length)return{topics:[],weakTopics:[],dominantCategory:null};let i=[...new Set(g.map(a=>a.question_id))],{data:j,error:k}=await b.from("admin_questions").select("id, topic, category").in("id",i);if(k)throw k;let l=new Map;(j||[]).forEach(a=>{l.set(a.id,{topic:a.topic??null,category:a.category??null})});let m={};g.forEach(a=>{let b=l.get(a.question_id);if(!b||!b.topic)return;let c=b.topic;m[c]||(m[c]={total:0,correct:0,category:b.category}),m[c].total+=1,a.is_correct&&(m[c].correct+=1)});let n=Object.entries(m).map(([a,b])=>{let c=b.total>0?b.correct/b.total:0;return{topic:a,totalQuestions:b.total,correct:b.correct,accuracy:c}}).sort((a,b)=>a.accuracy-b.accuracy),o=n.filter(a=>a.totalQuestions>=3&&a.accuracy<.8).slice(0,5),p={};o.forEach(a=>{let b=m[a.topic]?.category;b&&(p[b]=(p[b]||0)+1)});let q=null,r=0;if(Object.entries(p).forEach(([a,b])=>{b>r&&(r=b,q=a)}),!q&&n.length>0){let a={};Object.values(m).forEach(b=>{b.category&&(a[b.category]=(a[b.category]||0)+1)});let b=0;Object.entries(a).forEach(([a,c])=>{c>b&&(b=c,q=a)})}return{topics:n,weakTopics:o,dominantCategory:q}},enabled:!!a,staleTime:12e4})}a.s(["useClearAllTestAttempts",()=>j,"useDashboardStats",()=>g,"useDeleteTestAttempt",()=>i,"useGlobalDailyStreak",()=>f,"useTestCount",()=>k,"useTestHistory",()=>h,"useWeakTopics",()=>l])},81808,47715,a=>{"use strict";var b=a.i(2017);let c=(0,b.default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);a.s(["Target",()=>c],81808);let d=(0,b.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);a.s(["Activity",()=>d],47715)},59695,a=>{"use strict";let b=(0,a.i(2017).default)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);a.s(["Brain",()=>b],59695)}];

//# sourceMappingURL=Desktop_drivewise_2f8af3f5._.js.map