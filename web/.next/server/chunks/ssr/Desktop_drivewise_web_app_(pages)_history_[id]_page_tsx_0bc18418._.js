module.exports=[47433,a=>{"use strict";var b=a.i(681),c=a.i(84813),d=a.i(25761),e=a.i(78330),f=a.i(93639),g=a.i(663),h=a.i(90007),i=a.i(92347),j=a.i(1004),k=a.i(40591),l=a.i(94902),m=a.i(46667),n=a.i(96112),o=a.i(70604),p=a.i(34213),q=a.i(53365),r=a.i(81217),s=a.i(22309),t=a.i(66355);function u(){let a=(0,q.useParams)();(0,q.useRouter)();let u=a.id,v=(0,d.createClient)(),{language:w,t:x}=(0,r.useLanguage)(),{user:y,isAdmin:z}=(0,s.useAuth)(),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(0),{data:I,isLoading:J}=(0,t.useCategoryEntitlements)(y?.id,C?.category||void 0,z);(0,c.useEffect)(()=>{K()},[u]);let K=async()=>{F(!0);try{let{data:a,error:b}=await v.from("test_attempts").select("*").eq("id",u).single();if(b)throw b;D(a);let{data:c,error:d}=await v.from("test_attempt_answers").select("*").eq("test_attempt_id",u).order("answered_at",{ascending:!0});if(d)throw d;if(c&&c.length>0){let a=c.map(a=>a.question_id),{data:b,error:d}=await v.from("admin_questions").select("*").in("id",a);if(d)throw d;let e=c.map(a=>{let c=b?.find(b=>b.id===a.question_id);return{...a,question:c||null}});B(e)}else B([])}catch(a){}finally{F(!1)}};if(E||C&&J)return(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)(e.Navbar,{}),(0,b.jsxs)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(i.Skeleton,{className:"w-32 h-9 mb-4"}),(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Skeleton,{className:"w-64 h-8"}),(0,b.jsx)(i.Skeleton,{className:"w-48 h-4"})]}),(0,b.jsxs)("div",{className:"space-y-2 flex flex-col items-end",children:[(0,b.jsx)(i.Skeleton,{className:"w-20 h-8"}),(0,b.jsx)(i.Skeleton,{className:"w-24 h-4"})]})]})]}),(0,b.jsx)("div",{className:"mb-6 max-w-4xl mx-auto",children:(0,b.jsx)(f.GlassCard,{className:"p-4",children:(0,b.jsx)(i.Skeleton,{className:"w-full h-32"})})}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto mb-6",children:(0,b.jsxs)(f.GlassCard,{className:"p-6 h-[400px]",children:[(0,b.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,b.jsx)(i.Skeleton,{className:"w-10 h-10 rounded-lg"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Skeleton,{className:"w-40 h-6"}),(0,b.jsx)(i.Skeleton,{className:"w-24 h-4"})]})]}),(0,b.jsx)(i.Skeleton,{className:"w-full h-8 mb-6"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(i.Skeleton,{className:"w-full h-16 rounded-lg"}),(0,b.jsx)(i.Skeleton,{className:"w-full h-16 rounded-lg"}),(0,b.jsx)(i.Skeleton,{className:"w-full h-16 rounded-lg"})]})]})})]})]});if(!z&&I&&!I.entitlements.canReviewTestsInDetail){let a=(C?.category||"B").toUpperCase();return(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)(e.Navbar,{}),(0,b.jsx)("div",{className:"container mx-auto px-6 py-8 max-w-3xl pt-28",children:(0,b.jsxs)(f.GlassCard,{className:"p-8 border border-border/80 bg-black/85",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold mb-3",children:x("history.reviewPaywallTitle")||"Detailed review is part of the paid plan"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:x("history.reviewPaywallDescription")||"On the free plan you can see a simple test history, but question-by-question review with explanations is unlocked with a paid plan for this category."}),(0,b.jsxs)("ul",{className:"text-sm text-muted-foreground mb-4 list-disc pl-5 space-y-1",children:[(0,b.jsx)("li",{children:x("history.reviewPaywallBenefit1")||"See every question, your answer, and the correct answer."}),(0,b.jsx)("li",{children:x("history.reviewPaywallBenefit2")||"Read explanations so you remember why answers are correct."}),(0,b.jsx)("li",{children:x("history.reviewPaywallBenefit3")||"Spot patterns in your mistakes and fix them faster."})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsx)(g.Button,{asChild:!0,className:"flex-1",children:(0,b.jsx)(j.default,{href:`/pricing?category=${a}`,children:x("history.reviewPaywallUpgradeCta")||"See plans & upgrade"})}),(0,b.jsx)(g.Button,{asChild:!0,variant:"outline",className:"flex-1",children:(0,b.jsx)(j.default,{href:"/history",children:x("history.backToHistory")})})]})]})})]})}if(!C||0===A.length)return(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)(e.Navbar,{}),(0,b.jsx)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:(0,b.jsxs)(f.GlassCard,{className:"p-12 text-center border border-border/80 bg-black/80",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:x("history.notFoundTitle")}),(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsx)(j.default,{href:"/history",children:x("history.backToHistory")})})]})})]});let L={};A.forEach(a=>{let b=a.question,c=b?.topic;b&&c&&(L[c]||(L[c]={total:0,correct:0}),L[c].total+=1,a.is_correct&&(L[c].correct+=1))});let M=Object.entries(L).map(([a,b])=>{let c=b.total>0?b.correct/b.total:0;return{topic:a,total:b.total,correct:b.correct,accuracy:c}}).sort((a,b)=>a.accuracy-b.accuracy),N=M.filter(a=>a.total>=2&&a.accuracy<.8).slice(0,3),O=A[G],P=O?.question,Q=A.length,R=C.percentage>=80,S="mixed"===C.test_number,T="personalized"===C.test_number;if(!P)return(0,b.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,b.jsx)(e.Navbar,{}),(0,b.jsx)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:(0,b.jsxs)(f.GlassCard,{className:"p-12 text-center border border-border/80 bg-black/80",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:x("history.missingQuestionTitle")}),(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsx)(j.default,{href:"/history",children:x("history.backToHistory")})})]})})]});let U=O.selected_answer?O.selected_answer.split(","):[],V=P.correct_answers&&P.correct_answers.length>0?P.correct_answers:[P.correct_answer],W=P.question_text,X=P.explanation||"",Y=P.topic?encodeURIComponent(P.topic):"";return(0,b.jsxs)("div",{className:"relative min-h-screen bg-background text-foreground overflow-hidden",children:[(0,b.jsx)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0 -z-10 [mask-image:radial-gradient(60%_60%_at_50%_20%,#000_20%,transparent_70%)]",children:(0,b.jsxs)("svg",{className:"h-full w-full opacity-[0.06]",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("defs",{children:(0,b.jsx)("pattern",{id:"review-grid",width:"32",height:"32",patternUnits:"userSpaceOnUse",children:(0,b.jsx)("path",{d:"M32 0H0V32",fill:"none",stroke:"currentColor",strokeWidth:"0.4"})})}),(0,b.jsx)("rect",{width:"100%",height:"100%",fill:"url(#review-grid)"})]})}),(0,b.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-72 bg-gradient-to-b from-orange-500/25 via-transparent to-transparent blur-3xl"}),(0,b.jsxs)("div",{"aria-hidden":!0,className:"pointer-events-none absolute inset-0",children:[(0,b.jsx)("div",{className:"hidden lg:block absolute top-24 bottom-24 left-[10%] w-px bg-gradient-to-b from-transparent via-orange-500/25 to-transparent"}),(0,b.jsx)("div",{className:"hidden lg:block absolute top-24 bottom-24 right-[10%] w-px bg-gradient-to-b from-transparent via-orange-500/25 to-transparent"})]}),(0,b.jsx)(e.Navbar,{}),(0,b.jsxs)(p.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(g.Button,{variant:"ghost",asChild:!0,className:"mb-4",children:(0,b.jsxs)(j.default,{href:"/history",children:[(0,b.jsx)(k.ArrowLeft,{className:"w-4 h-4 mr-2"}),x("history.backToHistory")]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold mb-1",children:[x("category.licenseCategory")," ",C.category," - ","mixed"===C.test_number?x("test.mixedName"):"personalized"===C.test_number?x("test.personalizedName"):`${x("test.test")} #${C.test_number}`]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:x("history.reviewSubtitle")})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:`text-3xl font-bold ${R?"text-green-500":"text-red-500"}`,children:[C.percentage,"%"]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[C.score,"/",C.total_questions," correct"]})]})]})]}),M.length>0&&(0,b.jsx)("div",{className:"mb-6 max-w-4xl mx-auto",children:(0,b.jsx)(f.GlassCard,{className:"p-4 border border-border/80 bg-black/80",children:(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:x("history.topicsTitle")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:x("history.topicsSubtitle")})]}),N.length>0&&(0,b.jsxs)("p",{className:"text-xs font-medium text-amber-500",children:[x("history.weakTopicsPrefix")," ",N.map((a,c)=>(0,b.jsxs)("span",{children:[c>0&&", ",a.topic]},a.topic))]})]}),(0,b.jsx)("div",{className:"space-y-2",children:M.slice(0,4).map(a=>{let c=Math.round(100*a.accuracy),d=N.some(b=>b.topic===a.topic);return(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-medium truncate mr-2",children:a.topic}),(0,b.jsxs)("span",{className:`font-semibold ${d?"text-red-500":c>=90?"text-green-500":"text-amber-500"}`,children:[a.correct,"/",a.total," (",c,"%)"]})]}),(0,b.jsx)("div",{className:"w-full bg-secondary rounded-full h-2 overflow-hidden",children:(0,b.jsx)("div",{className:`h-2 rounded-full transition-all ${d?"bg-red-500/80":c>=90?"bg-green-500/80":"bg-amber-500/80"}`,style:{width:`${Math.max(8,c)}%`}})})]},a.topic)})})]})})}),(0,b.jsx)("div",{className:"mb-6 max-w-4xl mx-auto",children:(0,b.jsx)(f.GlassCard,{className:"p-4 border border-border/80 bg-black/80",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:x("test.nextStepsTitle")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:x(R?S||T?"test.nextStepsPassedMixedOrPersonalized":"test.nextStepsPassedStandard":T?"test.nextStepsFailedPersonalized":"test.nextStepsFailedStandard")})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(j.default,{href:`/category/${C.category.toLowerCase()}`,children:x("test.backToTests")})}),!T&&(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(j.default,{href:`/test/${C.category.toLowerCase()}/personalized`,children:x("test.practiceWeakPointsCta")})}),!S&&(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(j.default,{href:`/test/${C.category.toLowerCase()}/mixed`,children:x("test.mixedTestCta")})}),(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",asChild:!0,children:(0,b.jsx)(j.default,{href:"/decision-trainer",children:x("test.decisionTrainerCta")})})]})]})})}),(0,b.jsx)(h.Card,{className:`${P.image_url?"max-w-6xl":"max-w-4xl"} mx-auto mb-6 border border-border/80 bg-black/80`,children:(0,b.jsxs)(h.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${O.is_correct?"bg-green-500/20":"bg-red-500/20"}`,children:O.is_correct?(0,b.jsx)(m.CheckCircle,{className:"w-6 h-6 text-green-500"}):(0,b.jsx)(n.XCircle,{className:"w-6 h-6 text-red-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold",children:["Question ",G+1," of ",Q]}),(0,b.jsx)("p",{className:`text-sm ${O.is_correct?"text-green-500":"text-red-500"}`,children:x(O.is_correct?"test.correctTitle":"test.incorrectTitle")})]})]}),(0,b.jsxs)("div",{className:P.image_url?"grid grid-cols-1 lg:grid-cols-2 gap-6":"",children:[P.image_url&&(0,b.jsx)("div",{className:"flex flex-col",children:(0,b.jsx)("div",{className:"relative rounded-xl overflow-hidden border-2 border-border shadow-lg",children:(0,b.jsx)("img",{src:P.image_url,alt:"Question illustration",className:"w-full h-auto object-contain bg-muted/30",style:{maxHeight:"400px"}})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-lg font-medium mb-6",children:W}),(0,b.jsx)("div",{className:"space-y-3",children:["A","B","C"].map(a=>{let c=V.includes(a),d=U.includes(a),e=P[`option_${a.toLowerCase()}`];return(0,b.jsx)("div",{className:`p-4 rounded-lg border-2 ${c?"bg-green-500/10 border-green-500/50":d&&!c?"bg-red-500/10 border-red-500/50":"bg-muted/30 border-border"}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center mt-0.5 ${d?c?"border-green-500 bg-green-500":"border-red-500 bg-red-500":c?"border-green-500 bg-green-500":"border-border"}`,children:(d||c)&&(0,b.jsx)(o.CheckSquare,{className:"w-4 h-4 text-white"})}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("p",{className:"font-medium",children:[(0,b.jsxs)("span",{className:"font-bold mr-2",children:[a,"."]}),e]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[c&&(0,b.jsx)("span",{className:"text-green-500 text-xs font-semibold whitespace-nowrap",children:"✓ Correct"}),d&&!c&&(0,b.jsx)("span",{className:"text-red-500 text-xs font-semibold whitespace-nowrap",children:"✗ Your answer"}),d&&c&&(0,b.jsx)("span",{className:"text-green-500 text-xs font-semibold whitespace-nowrap",children:"✓ Your answer"})]})]})})]})},a)})}),X&&(0,b.jsxs)("div",{className:"mt-6 p-4 rounded-lg bg-muted/40 border border-border",children:[(0,b.jsx)("p",{className:"text-sm font-semibold mb-1",children:x("history.explanationTitle")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:X})]}),P.topic&&Y&&(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(g.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsx)(j.default,{href:`/materials?search=${Y}`,children:x("materials.title")})})})]})]})]})}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>H(Math.max(0,G-1)),disabled:0===G,children:[(0,b.jsx)(k.ArrowLeft,{className:"w-4 h-4 mr-2"}),x("test.previous")]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[x("test.question")," ",G+1," ",x("test.of")," ",Q]}),(0,b.jsxs)(g.Button,{variant:"outline",onClick:()=>H(Math.min(Q-1,G+1)),disabled:G===Q-1,children:[x("test.next"),(0,b.jsx)(l.ArrowRight,{className:"w-4 h-4 ml-2"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>H(Math.max(0,G-5)),disabled:0===G,className:"p-1 rounded hover:bg-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:(0,b.jsx)(k.ArrowLeft,{className:"w-3 h-3"})}),(0,b.jsx)("div",{className:"flex-1 overflow-x-auto scrollbar-hide",children:(0,b.jsx)("div",{className:"flex gap-1",children:A.map((a,c)=>{let d=Math.abs(c-G);return d>4&&0!==c&&c!==Q-1?null:5===d?(0,b.jsx)("span",{className:"px-1 text-xs text-muted-foreground",children:"..."},`ellipsis-${c}`):(0,b.jsx)("button",{onClick:()=>H(c),className:`min-w-[32px] h-8 px-2 rounded text-xs font-medium transition-colors ${c===G?"bg-primary text-primary-foreground":a.is_correct?"bg-green-500/20 text-green-500 hover:bg-green-500/30":"bg-red-500/20 text-red-500 hover:bg-red-500/30"}`,children:c+1},a.id)})})}),(0,b.jsx)("button",{onClick:()=>H(Math.min(Q-1,G+5)),disabled:G===Q-1,className:"p-1 rounded hover:bg-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:(0,b.jsx)(l.ArrowRight,{className:"w-3 h-3"})})]})]})]})]})}a.s(["default",()=>u])}];

//# sourceMappingURL=Desktop_drivewise_web_app_%28pages%29_history_%5Bid%5D_page_tsx_0bc18418._.js.map