module.exports=[6396,a=>{"use strict";let b=(0,a.i(2017).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["default",()=>b])},92347,a=>{"use strict";var b=a.i(681),c=a.i(46444);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("relative overflow-hidden rounded-xl bg-gradient-to-r from-muted/60 via-muted/35 to-muted/60","before:absolute before:inset-0 before:-translate-x-full before:bg-gradient-to-r before:from-transparent before:via-primary/18 before:to-transparent before:animate-[shimmer_1.4s_infinite]",a),...d})}a.s(["Skeleton",()=>d])},57737,a=>{"use strict";let b={freeTestLimitPerCategory:Number(process.env.NEXT_PUBLIC_FREE_TEST_LIMIT_PER_CATEGORY??"3"),paidTestLimitPerCategory:Number(process.env.NEXT_PUBLIC_PAID_TEST_LIMIT_PER_CATEGORY??"9999"),billingCycleDays:Number(process.env.NEXT_PUBLIC_BILLING_CYCLE_DAYS??"30"),bestValuePlan:process.env.NEXT_PUBLIC_PAYMENT_BEST_VALUE_PLAN??"PLAN_C",plans:[{id:"PLAN_A",label:"1 month",months:1,priceEur:3},{id:"PLAN_B",label:"2 months",months:2,priceEur:6},{id:"PLAN_C",label:"3 months",months:3,priceEur:8,badge:"BEST_VALUE",emphasize:!0}].reduce((a,b)=>{let c=b.priceEur/b.months;return a[b.id]={...b,pricePerMonthEur:c},a},{})};function c(a,b=new Date){if(!a)return!1;let d=new Date(a.startDate).getTime(),e=new Date(a.endDate).getTime(),f=b.getTime();return f>=d&&f<=e}function d(a){let{isAdmin:d,testsTakenThisCycle:e,activePlan:f,now:g}=a;if(d)return{canAccessTests:!0,canStartNewTest:!0,remainingFreeTests:void 0,canAccessDecisionTrainer:!0,canAccessStudyMaterial:!0,canReviewTestsInDetail:!0};if(f&&c({startDate:f.startDate,endDate:f.endDate},g))return{canAccessTests:!0,canStartNewTest:e<b.paidTestLimitPerCategory,remainingFreeTests:Math.max(0,b.paidTestLimitPerCategory-e),canAccessDecisionTrainer:!0,canAccessStudyMaterial:!0,canReviewTestsInDetail:!0};let h=Math.max(0,b.freeTestLimitPerCategory-e);return{canAccessTests:!0,canStartNewTest:h>0,remainingFreeTests:h,canAccessDecisionTrainer:!1,canAccessStudyMaterial:!1,canReviewTestsInDetail:!1}}function e(a){let{attempts:c,category:d,now:e}=a,f=e??new Date,g=new Date(f);g.setDate(g.getDate()-b.billingCycleDays+1);let h=g.getTime(),i=f.getTime();return c.filter(a=>{if(a.category!==d)return!1;let b=new Date(a.completed_at).getTime();return b>=h&&b<=i}).length}a.s(["BILLING_CONFIG",0,b,"computeEntitlements",()=>d,"countTestsInCurrentCycle",()=>e,"isPlanCurrentlyActive",()=>c])},66355,a=>{"use strict";var b=a.i(60854),c=a.i(25761),d=a.i(57737);function e(a){return(0,b.useQuery)({queryKey:["user-plans",a],queryFn:async()=>{let b=(0,c.createClient)(),{data:d,error:e}=await b.from("user_plans").select("*").eq("user_id",a);if(e)throw e;return d||[]},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function f(a,b){let c=e(a),f=new Date,g=!!b||(c.data||[]).some(a=>"active"===a.status&&(0,d.isPlanCurrentlyActive)({startDate:a.start_date,endDate:a.end_date},f));return{...c,hasAnyActivePlan:g}}function g(a,e,f){return(0,b.useQuery)({queryKey:["category-entitlements",a,e,f],queryFn:async()=>{let b=(0,c.createClient)(),[g,h]=await Promise.all([b.from("user_plans").select("*").eq("user_id",a).eq("category",e).order("end_date",{ascending:!1}).limit(1),b.from("test_attempts").select("category, completed_at").eq("user_id",a)]);if(g.error)throw g.error;if(h.error)throw h.error;let i=(g.data||[])[0],j=new Date,k=(0,d.countTestsInCurrentCycle)({attempts:(h.data||[]).map(a=>({category:a.category,completed_at:a.completed_at})),category:e,now:j}),l=i?{id:i.id,userId:i.user_id,category:i.category,planTier:i.plan_tier,startDate:i.start_date,endDate:i.end_date,isActive:"active"===i.status,createdAt:i.created_at}:null;return{entitlements:(0,d.computeEntitlements)({isAdmin:f,testsTakenThisCycle:k,activePlan:l?{planTier:l.planTier,startDate:l.startDate,endDate:l.endDate,isActive:l.isActive}:null,now:j}),plan:l,testsTakenThisCycle:k}},enabled:!!a&&!!e,staleTime:3e5})}a.s(["useCategoryEntitlements",()=>g,"useGlobalPremium",()=>f,"useUserPlans",()=>e])},46456,a=>{"use strict";let b=(0,a.i(2017).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],46456)},92265,a=>{"use strict";var b=a.i(6396);a.s(["Check",()=>b.default])},54366,a=>{"use strict";let b=(0,a.i(2017).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],54366)},66756,a=>{"use strict";let b=(0,a.i(2017).default)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);a.s(["Car",()=>b],66756)},78060,a=>{"use strict";a.s(["CATEGORY_INFO",0,{"traffic-lights":{name:"SemaforÃ«t",icon:"ðŸš¦",description:"MÃ«soni kur tÃ« ndaloni dhe tÃ« vazhdoni",color:"#ef4444"},signs:{name:"Shenjat e RrugÃ«s",icon:"ðŸ›‘",description:"MÃ«soni shenjat e ndalimit dhe paralajmÃ«rimit",color:"#f59e0b"},pedestrians:{name:"Siguria e KÃ«mbÃ«sorÃ«ve",icon:"ðŸš¶",description:"Mbroni pÃ«rdoruesit e pambrojtur tÃ« rrugÃ«s",color:"#3b82f6"},"right-of-way":{name:"PÃ«rparÃ«sia e Kalimit",icon:"ðŸ”„",description:"MÃ«soni kush ka pÃ«rparÃ«si nÃ« kryqÃ«zime",color:"#8b5cf6"},hazards:{name:"Rreziqet nÃ« RrugÃ«",icon:"âš ï¸",description:"PÃ«rballuni me motin dhe pengesat",color:"#eab308"},parking:{name:"Rregullat e Parkimit",icon:"ðŸ…¿ï¸",description:"MÃ«soni parkimin e sigurt dhe tÃ« ligjshÃ«m",color:"#06b6d4"}}])},33060,a=>{"use strict";let b=(0,a.i(2017).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);a.s(["Zap",()=>b],33060)},51933,a=>{"use strict";let b=(0,a.i(2017).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);a.s(["Trophy",()=>b],51933)},60587,a=>{"use strict";var b=a.i(60854),c=a.i(25761);function d(a){return(0,b.useQuery)({queryKey:["leaderboard",a],queryFn:async()=>{let b=(0,c.createClient)(),{data:d,error:e}=await b.from("decision_trainer_leaderboard").select("*").order("total_xp",{ascending:!1}).order("best_time_seconds",{ascending:!0});if(e)return{topTen:[],currentUserRank:null,totalUsers:0};let f=d||[],g=f.length,h=f.slice(0,10),i=null;if(a){let b=f.findIndex(b=>b.user_id===a);-1!==b&&(i={...f[b],rank:b+1,isInTopTen:b<10})}return{topTen:h,currentUserRank:i,totalUsers:g}},staleTime:3e4,refetchInterval:6e4})}a.s(["useLeaderboard",()=>d])},73080,a=>{"use strict";var b=a.i(60854),c=a.i(20416),d=a.i(37979),e=a.i(25761);function f(a,c){return(0,b.useQuery)({queryKey:["decision-trainer-progress",a,c],queryFn:async()=>{let b=(0,e.createClient)().from("decision_trainer_progress").select("*").eq("user_id",a);c&&(b=b.eq("category",c));let{data:d,error:f}=await b;if(f)throw f;return d||[]},enabled:!!a,staleTime:0,refetchOnMount:"always"})}function g(a){return(0,b.useQuery)({queryKey:["decision-trainer-stats",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("decision_trainer_progress").select("*").eq("user_id",a);if(d)throw d;let f=c||[],g=f.reduce((a,b)=>a+b.total_xp,0),h=f.reduce((a,b)=>a+b.scenarios_completed,0),i=f.reduce((a,b)=>a+b.correct_answers,0),j=f.reduce((a,b)=>a+b.total_attempts,0),k=Math.max(...f.map(a=>a.best_streak),0),l=Math.min(...f.map(a=>a.best_time_seconds).filter(a=>null!==a),1/0),m=j>0?Math.round(i/j*100):0;return{totalXp:g,totalScenarios:h,totalCorrect:i,totalAttempts:j,bestStreak:k,bestTime:l===1/0?null:l,accuracy:m,categoriesCompleted:f.length,categoryProgress:f}},enabled:!!a,staleTime:6e4})}function h(a){return(0,b.useQuery)({queryKey:["weak-scenario-ids",a],queryFn:async()=>{let b=(0,e.createClient)(),{data:c,error:d}=await b.from("decision_trainer_attempts").select("scenario_id, is_correct, created_at").eq("user_id",a).order("created_at",{ascending:!0});if(d)throw d;let f=new Map;(c||[]).forEach(a=>{f.set(a.scenario_id,a.is_correct)});let g=[];return f.forEach((a,b)=>{a||g.push(b)}),g},enabled:!!a,staleTime:0})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async({userId:a,category:b,attempts:c,totalTimeMs:d})=>{let f=(0,e.createClient)(),g=c.map(c=>({user_id:a,scenario_id:c.scenarioId,category:b,is_correct:c.isCorrect,selected_options:c.selectedOptions,time_taken_ms:c.timeTakenMs,xp_earned:c.xpEarned})),{error:h}=await f.from("decision_trainer_attempts").insert(g);if(h)throw h;let i=c.reduce((a,b)=>a+b.xpEarned,0),j=c.filter(a=>a.isCorrect).length,k=c.length,l=0,m=0;for(let a of c)a.isCorrect?l=Math.max(l,++m):m=0;let{data:n}=await f.from("decision_trainer_progress").select("*").eq("user_id",a).eq("category",b).maybeSingle(),o=(n?.total_xp||0)+i,p=(n?.scenarios_completed||0)+k,q=(n?.correct_answers||0)+j,r=(n?.total_attempts||0)+k,s=Math.max(n?.best_streak||0,l),t=Math.round(d/k/1e3),u=n?.best_time_seconds?Math.min(n.best_time_seconds,t):t,{data:v,error:w}=await f.from("decision_trainer_progress").upsert({user_id:a,category:b,total_xp:o,scenarios_completed:p,correct_answers:q,total_attempts:r,current_streak:l,best_streak:s,best_time_seconds:u,average_time_seconds:t,updated_at:new Date().toISOString()},{onConflict:"user_id,category"}).select().single();if(w)throw w;return{progress:v,sessionStats:{totalXpEarned:i,correctCount:j,totalCount:k,accuracy:Math.round(j/k*100),maxStreak:l,avgTimeSeconds:t}}},onSuccess:(b,c)=>{a.invalidateQueries({queryKey:["decision-trainer-progress",c.userId]}),a.invalidateQueries({queryKey:["decision-trainer-stats",c.userId]}),a.invalidateQueries({queryKey:["leaderboard"]})}})}a.s(["useCompleteCategory",()=>i,"useDecisionTrainerProgress",()=>f,"useDecisionTrainerStats",()=>g,"useWeakScenarioIds",()=>h])}];

//# sourceMappingURL=Desktop_drivewise_42ed200c._.js.map