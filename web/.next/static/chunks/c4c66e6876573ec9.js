(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94312,e=>{"use strict";var t=e.i(13105),l=e.i(20696);function a({className:e,...a}){return(0,t.jsx)("div",{className:(0,l.cn)("relative overflow-hidden rounded-xl bg-gradient-to-r from-muted/60 via-muted/35 to-muted/60","before:absolute before:inset-0 before:-translate-x-full before:bg-gradient-to-r before:from-transparent before:via-primary/18 before:to-transparent before:animate-[shimmer_1.4s_infinite]",e),...a})}e.s(["Skeleton",()=>a])},86480,e=>{"use strict";var t=e.i(13105),l=e.i(63795),a=e.i(20696);let r=(0,l.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-[11px] font-semibold tracking-tight transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-ring/70 focus:ring-offset-2 focus:ring-offset-background",{variants:{variant:{default:"border-transparent bg-primary/90 text-primary-foreground hover:bg-primary",secondary:"border-transparent bg-secondary/80 text-secondary-foreground hover:bg-secondary",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"border-border/70 text-foreground/80 bg-background/40",success:"border-transparent bg-green-500 text-white hover:bg-green-500/80",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-500/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-500/80"}},defaultVariants:{variant:"default"}});function s({className:e,variant:l,...s}){return(0,t.jsx)("div",{className:(0,a.cn)(r({variant:l}),e),...s})}e.s(["Badge",()=>s])},45951,e=>{"use strict";let t=(0,e.i(39898).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],45951)},87370,e=>{"use strict";let t=(0,e.i(39898).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>t])},67358,e=>{"use strict";var t=e.i(13105),l=e.i(95329),a=e.i(20696);let r=l.forwardRef(({className:e,type:l,...r},s)=>(0,t.jsx)("input",{type:l,className:(0,a.cn)("flex h-10 w-full rounded-xl border border-input/70 bg-background/60 px-3.5 py-2 text-sm text-foreground shadow-[0_8px_24px_rgba(0,0,0,0.7)] backdrop-blur-xl","transition-all duration-200 file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground/80","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/80 focus-visible:ring-offset-2 focus-visible:ring-offset-background","disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));r.displayName="Input",e.s(["Input",()=>r])},34893,e=>{"use strict";var t=e.i(13105),l=e.i(95329),a=e.i(20696);let r=l.forwardRef(({className:e,...l},r)=>(0,t.jsx)("label",{ref:r,className:(0,a.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...l}));r.displayName="Label",e.s(["Label",()=>r])},23563,e=>{"use strict";var t=e.i(13105),l=e.i(95329),a=e.i(20696);let r=l.forwardRef(({className:e,...l},r)=>(0,t.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-xl border border-input/70 bg-background/60 px-3.5 py-2.5 text-sm text-foreground shadow-[0_8px_24px_rgba(0,0,0,0.7)] backdrop-blur-xl","transition-all duration-200 placeholder:text-muted-foreground/80","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/80 focus-visible:ring-offset-2 focus-visible:ring-offset-background","disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...l}));r.displayName="Textarea",e.s(["Textarea",()=>r])},54538,e=>{"use strict";let t=(0,e.i(39898).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],54538)},52803,e=>{"use strict";let t=(0,e.i(39898).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],52803)},13490,e=>{"use strict";let t=(0,e.i(39898).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],13490)},72181,e=>{"use strict";let t=(0,e.i(39898).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],72181)},58598,e=>{"use strict";var t=e.i(13105),l=e.i(95329),a=e.i(20696),r=e.i(89473);let s=({open:e,onOpenChange:l,children:a})=>(0,t.jsx)(t.Fragment,{children:e&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-xl",onClick:()=>l?.(!1)}),(0,t.jsx)("div",{className:"relative z-50",children:a})]})}),i=l.forwardRef(({className:e,...l},r)=>(0,t.jsx)("div",{ref:r,className:(0,a.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl border border-border/70 bg-card/90 p-6 shadow-[0_24px_80px_rgba(0,0,0,0.9)] backdrop-blur-2xl duration-200",e),...l}));i.displayName="AlertDialogContent";let n=({className:e,...l})=>(0,t.jsx)("div",{className:(0,a.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...l});n.displayName="AlertDialogHeader";let c=({className:e,...l})=>(0,t.jsx)("div",{className:(0,a.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...l});c.displayName="AlertDialogFooter";let o=l.forwardRef(({className:e,...l},r)=>(0,t.jsx)("h2",{ref:r,className:(0,a.cn)("text-lg font-semibold",e),...l}));o.displayName="AlertDialogTitle";let d=l.forwardRef(({className:e,...l},r)=>(0,t.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...l}));d.displayName="AlertDialogDescription";let u=l.forwardRef(({className:e,...l},s)=>(0,t.jsx)(r.Button,{ref:s,className:(0,a.cn)("",e),...l}));u.displayName="AlertDialogAction";let x=l.forwardRef(({className:e,...l},s)=>(0,t.jsx)(r.Button,{ref:s,variant:"outline",className:(0,a.cn)("mt-2 sm:mt-0",e),...l}));x.displayName="AlertDialogCancel",e.s(["AlertDialog",()=>s,"AlertDialogAction",()=>u,"AlertDialogCancel",()=>x,"AlertDialogContent",()=>i,"AlertDialogDescription",()=>d,"AlertDialogFooter",()=>c,"AlertDialogHeader",()=>n,"AlertDialogTitle",()=>o])},7163,e=>{"use strict";let t=(0,e.i(39898).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],7163)},96962,e=>{"use strict";let t=(0,e.i(39898).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>t])},23901,e=>{"use strict";let t=(0,e.i(39898).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["default",()=>t])},24382,e=>{"use strict";var t=e.i(23901);e.s(["ChevronRight",()=>t.default])},29365,e=>{"use strict";var t=e.i(96962);e.s(["ChevronLeft",()=>t.default])},86046,e=>{"use strict";e.s(["CATEGORY_INFO",0,{"traffic-lights":{name:"SemaforÃ«t",icon:"ðŸš¦",description:"MÃ«soni kur tÃ« ndaloni dhe tÃ« vazhdoni",color:"#ef4444"},signs:{name:"Shenjat e RrugÃ«s",icon:"ðŸ›‘",description:"MÃ«soni shenjat e ndalimit dhe paralajmÃ«rimit",color:"#f59e0b"},pedestrians:{name:"Siguria e KÃ«mbÃ«sorÃ«ve",icon:"ðŸš¶",description:"Mbroni pÃ«rdoruesit e pambrojtur tÃ« rrugÃ«s",color:"#3b82f6"},"right-of-way":{name:"PÃ«rparÃ«sia e Kalimit",icon:"ðŸ”„",description:"MÃ«soni kush ka pÃ«rparÃ«si nÃ« kryqÃ«zime",color:"#8b5cf6"},hazards:{name:"Rreziqet nÃ« RrugÃ«",icon:"âš ï¸",description:"PÃ«rballuni me motin dhe pengesat",color:"#eab308"},parking:{name:"Rregullat e Parkimit",icon:"ðŸ…¿ï¸",description:"MÃ«soni parkimin e sigurt dhe tÃ« ligjshÃ«m",color:"#06b6d4"}}])},93138,e=>{"use strict";var t=e.i(13105),l=e.i(95329),a=e.i(55744),r=e.i(96755),s=e.i(20401),i=e.i(89473),n=e.i(67358),c=e.i(4063),o=e.i(86480),d=e.i(94312),u=e.i(42830),x=e.i(23563),m=e.i(34893),h=e.i(45951),p=e.i(72181),g=e.i(13490),f=e.i(54538),v=e.i(7163),b=e.i(57157),j=e.i(52803),N=e.i(29365),y=e.i(24382),w=e.i(33212),S=e.i(90582),_=e.i(77886),k=e.i(86046),C=e.i(58598);function A(){let{user:e,loading:A}=(0,r.useAuth)(),I=(0,a.useRouter)(),[D,L]=(0,l.useState)([]),[T,R]=(0,l.useState)(0),[q,P]=(0,l.useState)(!0),[B,M]=(0,l.useState)(1),[O]=(0,l.useState)(20),[z,F]=(0,l.useState)(""),[V,E]=(0,l.useState)("all"),[G,U]=(0,l.useState)("all"),[$,H]=(0,l.useState)("all"),[X,K]=(0,l.useState)("all"),[Y,Q]=(0,l.useState)(!1),[J,W]=(0,l.useState)(null),[Z,ee]=(0,l.useState)(null),[et,el]=(0,l.useState)(""),[ea,er]=(0,l.useState)(!1),[es,ei]=(0,l.useState)(!1),[en,ec]=(0,l.useState)(null),[eo,ed]=(0,l.useState)({category:"traffic-lights",level:1,question:"",image_url:"",options:[{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""}],correct_explanation:"",real_world_tip:"",xp:25,chapter_id:1,is_published:!0}),eu=()=>{W(null),ee(null),el(""),ed({category:"traffic-lights",level:1,question:"",image_url:"",options:[{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""},{text:"",isCorrect:!1,explanation:""}],correct_explanation:"",real_world_tip:"",xp:25,chapter_id:1,is_published:!0})},ex=()=>{Q(!1),eu()},em=Math.ceil(T/O),eh=B<em,ep=B>1;(0,l.useEffect)(()=>{if(!Z)return;let e=URL.createObjectURL(Z);return el(e),()=>URL.revokeObjectURL(e)},[Z]);let eg=(0,l.useCallback)(async(e=1,t=!1)=>{try{t&&P(!0);let l=(0,S.createClient)().from("decision_trainer_scenarios").select("*",{count:"exact"});z.trim()&&(l=l.or(`question.ilike.%${z}%,correct_explanation.ilike.%${z}%,real_world_tip.ilike.%${z}%`)),"all"!==V&&(l=l.eq("category",V)),"all"!==G&&(l=l.eq("level",parseInt(G))),"all"!==$&&(l=l.eq("is_active","active"===$)),"all"!==X&&(l=l.eq("is_published","published"===X));let a=(e-1)*O,r=a+O-1,{data:s,error:i,count:n}=await l.order("created_at",{ascending:!1}).range(a,r);if(i)throw i;L(s||[]),R(n||0),M(e)}catch(t){let e=t.message||"Failed to load scenarios";e.includes("42P01")?_.toast.error("Decision trainer table not found. Please run the database migration."):e.includes("42501")?_.toast.error("Permission denied. Please check your admin privileges."):_.toast.error(e)}finally{P(!1)}},[z,V,G,$,X,O]);(0,l.useEffect)(()=>{let t=setTimeout(()=>{e&&(M(1),eg(1,!0))},300);return()=>clearTimeout(t)},[z,eg,e]),(0,l.useEffect)(()=>{e&&(M(1),eg(1,!0))},[V,G,$,X,eg,e]),(0,l.useEffect)(()=>{A||e?e&&eg(1,!0):I.push("/login")},[e,A,I,eg]);let ef=(e,t)=>{ed(l=>({...l,[e]:t}))},ev=(e,t,l)=>{ed(a=>{let r=[...a.options];return r[e]={...r[e],[t]:l},{...a,options:r}})},eb=async e=>{if(e.preventDefault(),!ea)try{let e=eo.question.trim();if(!e)return void _.toast.error("Question is required");let t=eo.options.map(e=>({...e,text:e.text.trim(),explanation:e.explanation?.trim()||""})).filter(e=>e.text.length>0);if(t.length<2)return void _.toast.error("Please provide at least two answer options");if(!t.some(e=>e.isCorrect))return void _.toast.error("Please mark at least one option as correct");let l=eo.correct_explanation.trim();if(!l)return void _.toast.error("Correct explanation is required");let a=eo.real_world_tip.trim();if(!a)return void _.toast.error("Real-world tip is required");if(!eo.xp||eo.xp<=0)return void _.toast.error("XP must be greater than 0");er(!0);let r=(0,S.createClient)(),s=eo.image_url||"";if(Z){let e=Z.name.split(".").pop(),t=`${Date.now()}-${Math.random().toString(36).slice(2,8)}.${e}`,l=`scenario-images/${t}`,{error:a}=await r.storage.from("decision-trainer").upload(l,Z);if(a){_.toast.error("Failed to upload image"),er(!1);return}let{data:i}=r.storage.from("decision-trainer").getPublicUrl(l);s=i.publicUrl}if(J){let{error:i}=await r.from("decision_trainer_scenarios").update({category:eo.category,level:eo.level,question:e,image_url:s||null,options:t,correct_explanation:l,real_world_tip:a,xp:eo.xp,chapter_id:eo.chapter_id||null}).eq("id",J.id);if(i){_.toast.error("Failed to update scenario"),er(!1);return}_.toast.success("Scenario updated successfully")}else{let i=`scn-${Date.now()}`,{error:n}=await r.from("decision_trainer_scenarios").insert({id:i,category:eo.category,level:eo.level,question:e,image_url:s||null,options:t,correct_explanation:l,real_world_tip:a,xp:eo.xp,is_active:!0,chapter_id:eo.chapter_id||null});if(n){_.toast.error("Failed to create scenario"),er(!1);return}_.toast.success("Scenario created successfully")}ex(),eg(B,!0)}catch(e){_.toast.error("Failed to save scenario")}finally{er(!1)}},ej=()=>(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:O}).map((e,l)=>(0,t.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-3/4 mb-2"}),(0,t.jsx)(d.Skeleton,{className:"h-3 w-1/2 mb-4"}),(0,t.jsx)(d.Skeleton,{className:"h-20 w-full mb-2"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(d.Skeleton,{className:"h-8 w-16"}),(0,t.jsx)(d.Skeleton,{className:"h-8 w-16"})]})]},l))});return A||q?(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(s.Navbar,{}),(0,t.jsxs)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Skeleton,{className:"h-8 w-48 mb-2"}),(0,t.jsx)(d.Skeleton,{className:"h-4 w-32"})]}),(0,t.jsx)(d.Skeleton,{className:"h-10 w-32"})]}),(0,t.jsx)(ej,{})]})]}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,t.jsx)(s.Navbar,{}),(0,t.jsxs)("div",{className:"container mx-auto px-6 py-8 max-w-7xl pt-28",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center gap-4 mb-2",children:(0,t.jsx)(i.Button,{variant:"ghost",asChild:!0,children:(0,t.jsxs)(w.default,{href:"/admin",children:[(0,t.jsx)(h.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Admin"]})})}),(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Decision Trainer Scenarios"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Manage interactive driving scenarios (",T," total)"]})]}),(0,t.jsxs)(i.Button,{onClick:()=>{eu(),Q(!0)},children:[(0,t.jsx)(p.Plus,{className:"w-4 h-4 mr-2"}),"Add Scenario"]})]}),(0,t.jsx)(u.GlassCard,{className:"p-6 mb-6 border border-border/80 bg-black/80",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)(j.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,t.jsx)(n.Input,{placeholder:"Search scenarios...",value:z,onChange:e=>F(e.target.value),className:"pl-10"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)(c.Select,{value:V,onValueChange:E,children:[(0,t.jsx)(c.SelectTrigger,{className:"w-40 min-w-[9rem]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Category"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"all",children:"All Categories"}),Object.entries(k.CATEGORY_INFO).map(([e,l])=>(0,t.jsx)(c.SelectItem,{value:e,children:l.name},e))]})]}),(0,t.jsxs)(c.Select,{value:G,onValueChange:U,children:[(0,t.jsx)(c.SelectTrigger,{className:"w-32 min-w-[7rem]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Level"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"all",children:"All Levels"}),(0,t.jsx)(c.SelectItem,{value:"1",children:"Level 1"}),(0,t.jsx)(c.SelectItem,{value:"2",children:"Level 2"}),(0,t.jsx)(c.SelectItem,{value:"3",children:"Level 3"}),(0,t.jsx)(c.SelectItem,{value:"4",children:"Level 4"})]})]}),(0,t.jsxs)(c.Select,{value:$,onValueChange:H,children:[(0,t.jsx)(c.SelectTrigger,{className:"w-32 min-w-[7rem]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Status"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"all",children:"All Status"}),(0,t.jsx)(c.SelectItem,{value:"active",children:"Active"}),(0,t.jsx)(c.SelectItem,{value:"inactive",children:"Inactive"})]})]}),(0,t.jsxs)(c.Select,{value:X,onValueChange:K,children:[(0,t.jsx)(c.SelectTrigger,{className:"w-32 min-w-[7rem]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Published"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"all",children:"All Publish"}),(0,t.jsx)(c.SelectItem,{value:"published",children:"Published"}),(0,t.jsx)(c.SelectItem,{value:"draft",children:"Draft"})]})]})]})]}),(z||"all"!==V||"all"!==G||"all"!==$)&&(0,t.jsxs)(i.Button,{variant:"outline",onClick:()=>{F(""),E("all"),U("all"),H("all"),K("all")},children:[(0,t.jsx)(b.X,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})]})}),q?(0,t.jsx)(ej,{}):0===D.length?(0,t.jsxs)(u.GlassCard,{className:"p-12 text-center border border-border/80 bg-black/80",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"ðŸŽ¯"}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-2",children:"No scenarios found"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:z||"all"!==V||"all"!==G||"all"!==$?"Try adjusting your filters or search query.":"Get started by creating your first scenario."}),(0,t.jsxs)(i.Button,{onClick:()=>Q(!0),children:[(0,t.jsx)(p.Plus,{className:"w-4 h-4 mr-2"}),"Add First Scenario"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:D.map(e=>(0,t.jsxs)(u.GlassCard,{className:"p-6 border border-border/80 bg-black/80 hover:border-primary/50 hover:shadow-[0_22px_60px_rgba(0,0,0,0.9)] transition-all",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.Badge,{variant:"outline",children:k.CATEGORY_INFO[e.category]?.name||e.category}),(0,t.jsxs)(o.Badge,{variant:"secondary",children:["Level ",e.level]}),(0,t.jsx)(o.Badge,{variant:e.is_active?"default":"destructive",children:e.is_active?"Active":"Inactive"}),(0,t.jsx)(o.Badge,{variant:!1!==e.is_published?"outline":"destructive",children:!1!==e.is_published?"Published":"Draft"})]})}),(0,t.jsx)("h3",{className:"font-semibold mb-2 line-clamp-2",children:e.question}),e.image_url&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)("img",{src:e.image_url,alt:"Scenario",className:"w-full h-32 object-cover rounded-md"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:e.correct_explanation}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-primary",children:[e.xp," XP"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.Button,{size:"sm",variant:"outline",onClick:()=>{W(e),ed({category:e.category,level:e.level,question:e.question,image_url:e.image_url||"",options:e.options,correct_explanation:e.correct_explanation,real_world_tip:e.real_world_tip,xp:e.xp,chapter_id:e.chapter_id||1,is_published:!1!==e.is_published}),el(e.image_url||""),Q(!0)},children:(0,t.jsx)(g.Edit,{className:"w-4 h-4"})}),(0,t.jsx)(i.Button,{size:"sm",variant:"destructive",onClick:()=>{ec(e.id),ei(!0)},children:(0,t.jsx)(f.Trash2,{className:"w-4 h-4"})})]})]})]},e.id))}),em>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",(B-1)*O+1," to ",Math.min(B*O,T)," of ",T," scenarios"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>{ep&&eg(B-1,!0)},disabled:!ep,children:[(0,t.jsx)(N.ChevronLeft,{className:"w-4 h-4"}),"Previous"]}),(0,t.jsx)("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,em)},(e,l)=>{let a;return a=em<=5||B<=3?l+1:B>=em-2?em-4+l:B-2+l,(0,t.jsx)(i.Button,{variant:a===B?"default":"outline",size:"sm",onClick:()=>{a>=1&&a<=em&&eg(a,!0)},className:"w-10",children:a},a)})}),(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>{eh&&eg(B+1,!0)},disabled:!eh,children:["Next",(0,t.jsx)(y.ChevronRight,{className:"w-4 h-4"})]})]})]})]})]}),Y&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-full max-w-4xl mx-4",children:(0,t.jsxs)(u.GlassCard,{className:"p-6 border border-border/80 bg-black/90 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:J?"Edit Scenario":"Add Scenario"}),(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:ex,children:(0,t.jsx)(b.X,{className:"w-4 h-4"})})]}),(0,t.jsxs)("form",{className:"space-y-6",onSubmit:eb,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Label,{className:"mb-1 block",children:"Category"}),(0,t.jsxs)(c.Select,{value:eo.category,onValueChange:e=>ef("category",e),children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select category"})}),(0,t.jsx)(c.SelectContent,{children:Object.entries(k.CATEGORY_INFO).map(([e,l])=>(0,t.jsx)(c.SelectItem,{value:e,children:l.name},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Label,{className:"mb-1 block",children:"Level"}),(0,t.jsxs)(c.Select,{value:String(eo.level),onValueChange:e=>ef("level",parseInt(e)),children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select level"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"1",children:"Level 1"}),(0,t.jsx)(c.SelectItem,{value:"2",children:"Level 2"}),(0,t.jsx)(c.SelectItem,{value:"3",children:"Level 3"}),(0,t.jsx)(c.SelectItem,{value:"4",children:"Level 4"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Label,{className:"mb-1 block",children:"XP"}),(0,t.jsx)(n.Input,{type:"number",min:0,value:eo.xp,onChange:e=>ef("xp",parseInt(e.target.value||"0"))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Label,{className:"mb-1 block",children:"Chapter (optional)"}),(0,t.jsx)(n.Input,{type:"number",min:1,max:20,value:eo.chapter_id??"",onChange:e=>{let t=e.target.value;ef("chapter_id",""===t?null:parseInt(t,10)||null)},placeholder:"e.g. 5"})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Label,{className:"mb-1 block",children:"Status"}),(0,t.jsxs)(c.Select,{value:eo.is_published?"published":"draft",onValueChange:e=>ed(t=>({...t,is_published:"published"===e})),children:[(0,t.jsx)(c.SelectTrigger,{children:(0,t.jsx)(c.SelectValue,{placeholder:"Select status"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"published",children:"Published"}),(0,t.jsx)(c.SelectItem,{value:"draft",children:"Draft"})]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{className:"block",children:"Question"}),(0,t.jsx)(x.Textarea,{value:eo.question,onChange:e=>ef("question",e.target.value),placeholder:"Enter the scenario question..."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{className:"block",children:"Correct Explanation"}),(0,t.jsx)(x.Textarea,{value:eo.correct_explanation,onChange:e=>ef("correct_explanation",e.target.value),placeholder:"Explain why the correct answer is right..."})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{className:"block",children:"Real-world Tip"}),(0,t.jsx)(x.Textarea,{value:eo.real_world_tip,onChange:e=>ef("real_world_tip",e.target.value),placeholder:"Give a practical real-world driving tip..."})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(m.Label,{className:"block",children:"Answer Options"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Mark all correct answers (multiple correct options supported)"})]}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:eo.options.map((e,l)=>(0,t.jsxs)("div",{className:"space-y-2 border rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("span",{className:"text-xs font-medium text-muted-foreground",children:["Option ",l+1]}),(0,t.jsx)(i.Button,{type:"button",size:"sm",variant:e.isCorrect?"default":"outline",onClick:()=>{ed(e=>{let t=e.options.map((e,t)=>t===l?{...e,isCorrect:!e.isCorrect}:e);return{...e,options:t}})},children:e.isCorrect?"Correct":"Mark Correct"})]}),(0,t.jsx)(n.Input,{placeholder:"Option text",value:e.text,onChange:e=>ev(l,"text",e.target.value)}),(0,t.jsx)(x.Textarea,{placeholder:"Optional explanation for this option",value:e.explanation,onChange:e=>ev(l,"explanation",e.target.value),className:"mt-2"})]},l))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(m.Label,{className:"block",children:"Image (optional)"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(i.Button,{type:"button",variant:"outline",className:"flex items-center gap-2 relative overflow-hidden",children:[(0,t.jsx)(v.Image,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Choose Image"}),(0,t.jsx)("input",{type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:e=>{let t=e.target.files?.[0]??null;t&&ee(t)}})]}),et&&(0,t.jsx)("div",{className:"w-24 h-16 rounded-md overflow-hidden border",children:(0,t.jsx)("img",{src:et,alt:"Preview",className:"w-full h-full object-cover"})})]}),eo.image_url&&!et&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground break-all",children:["Current image: ",eo.image_url]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 pt-2",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",onClick:ex,disabled:ea,className:"w-full sm:w-auto",children:"Cancel"}),(0,t.jsx)(i.Button,{type:"submit",disabled:ea,className:"w-full sm:w-auto",children:ea?"Saving...":J?"Save Changes":"Create Scenario"})]})]})]})})}),(0,t.jsx)(C.AlertDialog,{open:es,onOpenChange:ei,children:(0,t.jsxs)(C.AlertDialogContent,{children:[(0,t.jsxs)(C.AlertDialogHeader,{children:[(0,t.jsx)(C.AlertDialogTitle,{children:"Delete Scenario"}),(0,t.jsx)(C.AlertDialogDescription,{children:"Are you sure you want to delete this scenario? This action cannot be undone."})]}),(0,t.jsxs)(C.AlertDialogFooter,{children:[(0,t.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(C.AlertDialogAction,{onClick:async()=>{if(en)try{let e=(0,S.createClient)(),{error:t}=await e.from("decision_trainer_scenarios").delete().eq("id",en);if(t)throw t;_.toast.success("Scenario deleted successfully"),eg(B,!0)}catch(e){_.toast.error("Failed to delete scenario")}finally{ei(!1),ec(null)}},children:"Delete"})]})]})})]}):null}e.s(["default",()=>A])}]);