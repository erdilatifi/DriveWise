(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3604,e=>{"use strict";var t=e.i(95329),r=e.i(33133),s=e.i(50863),a=e.i(8181),i=e.i(921),n=class extends a.Subscribable{#e;#t=void 0;#r;#s;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.hashKey)(t.mutationKey)!==(0,i.hashKey)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#a(),this.#i()}mutate(e,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#a(){let e=this.#r?.state??(0,r.getDefaultState)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){s.notifyManager.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#s.onSuccess?.(e.data,t,r,s),this.#s.onSettled?.(e.data,null,t,r,s)):e?.type==="error"&&(this.#s.onError?.(e.error,t,r,s),this.#s.onSettled?.(void 0,e.error,t,r,s))}this.listeners.forEach(e=>{e(this.#t)})})}},o=e.i(94494);function u(e,r){let a=(0,o.useQueryClient)(r),[u]=t.useState(()=>new n(a,e));t.useEffect(()=>{u.setOptions(e)},[u,e]);let c=t.useSyncExternalStore(t.useCallback(e=>u.subscribe(s.notifyManager.batchCalls(e)),[u]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),l=t.useCallback((e,t)=>{u.mutate(e,t).catch(i.noop)},[u]);if(c.error&&(0,i.shouldThrowError)(u.options.throwOnError,[c.error]))throw c.error;return{...c,mutate:l,mutateAsync:c.mutate}}e.s(["useMutation",()=>u],3604)},94312,e=>{"use strict";var t=e.i(13105),r=e.i(20696);function s({className:e,...s}){return(0,t.jsx)("div",{className:(0,r.cn)("relative overflow-hidden rounded-xl bg-gradient-to-r from-muted/60 via-muted/35 to-muted/60","before:absolute before:inset-0 before:-translate-x-full before:bg-gradient-to-r before:from-transparent before:via-primary/18 before:to-transparent before:animate-[shimmer_1.4s_infinite]",e),...s})}e.s(["Skeleton",()=>s])},77248,e=>{"use strict";let t=(0,e.i(39898).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],77248)},6231,e=>{"use strict";e.s(["CATEGORY_INFO",0,{A:{name:"Kategoria A",description:"Motoçikleta"},B:{name:"Kategoria B",description:"Vetura"},C:{name:"Kategoria C",description:"Kamionë"},D:{name:"Kategoria D",description:"Autobusë"}}])},51699,e=>{"use strict";let t=(0,e.i(39898).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],51699)},29032,e=>{"use strict";let t=(0,e.i(39898).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);e.s(["TrendingUp",()=>t],29032)},97947,e=>{"use strict";let t=(0,e.i(39898).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>t],97947)},88717,e=>{"use strict";let t=(0,e.i(39898).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);e.s(["Trophy",()=>t],88717)},87781,e=>{"use strict";var t=e.i(55650),r=e.i(3604),s=e.i(94494),a=e.i(90582);function i(e,r){return(0,t.useQuery)({queryKey:["decision-trainer-progress",e,r],queryFn:async()=>{let t=(0,a.createClient)().from("decision_trainer_progress").select("*").eq("user_id",e);r&&(t=t.eq("category",r));let{data:s,error:i}=await t;if(i)throw i;return s||[]},enabled:!!e,staleTime:0,refetchOnMount:"always"})}function n(e){return(0,t.useQuery)({queryKey:["decision-trainer-stats",e],queryFn:async()=>{let t=(0,a.createClient)(),{data:r,error:s}=await t.from("decision_trainer_progress").select("*").eq("user_id",e);if(s)throw s;let i=r||[],n=i.reduce((e,t)=>e+t.total_xp,0),o=i.reduce((e,t)=>e+t.scenarios_completed,0),u=i.reduce((e,t)=>e+t.correct_answers,0),c=i.reduce((e,t)=>e+t.total_attempts,0),l=Math.max(...i.map(e=>e.best_streak),0),d=Math.min(...i.map(e=>e.best_time_seconds).filter(e=>null!==e),1/0),h=c>0?Math.round(u/c*100):0;return{totalXp:n,totalScenarios:o,totalCorrect:u,totalAttempts:c,bestStreak:l,bestTime:d===1/0?null:d,accuracy:h,categoriesCompleted:i.length,categoryProgress:i}},enabled:!!e,staleTime:6e4})}function o(e){return(0,t.useQuery)({queryKey:["weak-scenario-ids",e],queryFn:async()=>{let t=(0,a.createClient)(),{data:r,error:s}=await t.from("decision_trainer_attempts").select("scenario_id, is_correct, created_at").eq("user_id",e).order("created_at",{ascending:!0});if(s)throw s;let i=new Map;(r||[]).forEach(e=>{i.set(e.scenario_id,e.is_correct)});let n=[];return i.forEach((e,t)=>{e||n.push(t)}),n},enabled:!!e,staleTime:0})}function u(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:async({userId:e,category:t,attempts:r,totalTimeMs:s})=>{let i=(0,a.createClient)(),n=r.map(r=>({user_id:e,scenario_id:r.scenarioId,category:t,is_correct:r.isCorrect,selected_options:r.selectedOptions,time_taken_ms:r.timeTakenMs,xp_earned:r.xpEarned})),{error:o}=await i.from("decision_trainer_attempts").insert(n);if(o)throw o;let u=r.reduce((e,t)=>e+t.xpEarned,0),c=r.filter(e=>e.isCorrect).length,l=r.length,d=0,h=0;for(let e of r)e.isCorrect?d=Math.max(d,++h):h=0;let{data:p}=await i.from("decision_trainer_progress").select("*").eq("user_id",e).eq("category",t).maybeSingle(),y=(p?.total_xp||0)+u,m=(p?.scenarios_completed||0)+l,_=(p?.correct_answers||0)+c,f=(p?.total_attempts||0)+l,g=Math.max(p?.best_streak||0,d),b=Math.round(s/l/1e3),w=p?.best_time_seconds?Math.min(p.best_time_seconds,b):b,{data:M,error:k}=await i.from("decision_trainer_progress").upsert({user_id:e,category:t,total_xp:y,scenarios_completed:m,correct_answers:_,total_attempts:f,current_streak:d,best_streak:g,best_time_seconds:w,average_time_seconds:b,updated_at:new Date().toISOString()},{onConflict:"user_id,category"}).select().single();if(k)throw k;return{progress:M,sessionStats:{totalXpEarned:u,correctCount:c,totalCount:l,accuracy:Math.round(c/l*100),maxStreak:d,avgTimeSeconds:b}}},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["decision-trainer-progress",r.userId]}),e.invalidateQueries({queryKey:["decision-trainer-stats",r.userId]}),e.invalidateQueries({queryKey:["leaderboard"]})}})}e.s(["useCompleteCategory",()=>u,"useDecisionTrainerProgress",()=>i,"useDecisionTrainerStats",()=>n,"useWeakScenarioIds",()=>o])},9713,e=>{"use strict";var t=e.i(55650),r=e.i(3604),s=e.i(94494),a=e.i(90582);function i(e){return(0,t.useQuery)({queryKey:["global-daily-streak",e],queryFn:async()=>{let t=(0,a.createClient)(),{data:r,error:s}=await t.from("test_attempts").select("completed_at").eq("user_id",e);if(s)throw s;let{data:i,error:n}=await t.from("decision_trainer_attempts").select("created_at").eq("user_id",e);if(n)throw n;let o=[];(r||[]).forEach(e=>{let t=new Date(e.completed_at);o.push(new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime())}),(i||[]).forEach(e=>{let t=new Date(e.created_at);o.push(new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime())});let u=[...new Set(o)].sort((e,t)=>t-e);if(0===u.length)return{currentStreak:0,bestStreak:0};let c=new Date,l=new Date(c.getFullYear(),c.getMonth(),c.getDate()).getTime(),d=0,h=0;if(u[0]===l||u[0]===l-864e5){d=1,h=1;for(let e=1;e<u.length;e++){let t=u[e-1]-864e5;if(u[e]===t)++d>h&&(h=d);else break}}return{currentStreak:d,bestStreak:h}},enabled:!!e,staleTime:0,refetchOnMount:"always"})}function n(e){return(0,t.useQuery)({queryKey:["dashboard-stats",e],queryFn:async()=>{let t=(0,a.createClient)();try{let[r,s,a,i]=await Promise.all([t.rpc("get_dashboard_stats",{p_user_id:e}),t.rpc("get_weekly_progress",{p_user_id:e}),t.rpc("get_recent_tests",{p_user_id:e,p_limit:4}),t.from("test_attempts").select("completed_at").eq("user_id",e).order("completed_at",{ascending:!1})]);if(r.error)throw r.error;if(s.error)throw s.error;if(a.error)throw a.error;let n=r.data?.[0]||{total_tests:0,average_score:0,best_score:0,tests_this_week:0,passed_tests:0,failed_tests:0},o=(i.data||[]).map(e=>{let t=new Date(e.completed_at);return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}),u=[...new Set(o)].sort((e,t)=>t-e),c=0,l=new Date,d=new Date(l.getFullYear(),l.getMonth(),l.getDate()).getTime();if(u.length>0&&(u[0]===d||u[0]===d-864e5)){c=1;for(let e=1;e<u.length;e++){let t=u[e-1]-864e5;if(u[e]===t)c++;else break}}let h=[],p=s.data||[];for(let e=6;e>=0;e--){let t=new Date;t.setDate(t.getDate()-e);let r=t.toISOString().split("T")[0],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],a=p.find(e=>e.attempt_date===r);h.push({date:s,score:a?a.daily_avg_score:0})}let y=(a.data||[]).map(e=>({id:e.id,category:e.category,testNumber:e.test_number||"1",score:Number(e.percentage),date:new Date(e.completed_at).toLocaleDateString(),passed:Number(e.percentage)>=80}));return{stats:{totalTests:n.total_tests,averageScore:n.average_score,bestScore:n.best_score,testsThisWeek:n.tests_this_week,streak:c,passedTests:n.passed_tests,failedTests:n.failed_tests},progressData:h,recentTests:y}}catch(e){return{stats:{totalTests:0,averageScore:0,bestScore:0,testsThisWeek:0,streak:0,passedTests:0,failedTests:0},progressData:[],recentTests:[]}}},enabled:!!e,staleTime:12e4})}function o(e,r=1,s=6){return(0,t.useQuery)({queryKey:["test-history",e,r,s],queryFn:async()=>{let t=(0,a.createClient)(),i=(r-1)*s,[n,o]=await Promise.all([t.from("test_attempts").select("*").eq("user_id",e).order("completed_at",{ascending:!1}).range(i,i+s-1),t.from("test_attempts").select("*",{count:"exact",head:!0}).eq("user_id",e)]);if(n.error)throw n.error;if(o.error)throw o.error;return{tests:n.data||[],totalCount:o.count||0,totalPages:Math.ceil((o.count||0)/s)}},enabled:!!e,staleTime:0,refetchOnMount:"always"})}function u(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:async e=>{let t=(0,a.createClient)(),{error:r}=await t.from("test_attempts").delete().eq("id",e);if(r)throw r},onSuccess:()=>{e.invalidateQueries({queryKey:["test-attempts"]}),e.invalidateQueries({queryKey:["dashboard-stats"]}),e.invalidateQueries({queryKey:["test-history"]})}})}function c(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:async e=>{let t=(0,a.createClient)(),{error:r}=await t.from("test_attempts").delete().eq("user_id",e);if(r)throw r},onSuccess:()=>{e.invalidateQueries({queryKey:["test-attempts"]}),e.invalidateQueries({queryKey:["dashboard-stats"]}),e.invalidateQueries({queryKey:["test-history"]})}})}function l(e,r=!0){return(0,t.useQuery)({queryKey:["test-count",e],queryFn:async()=>{let t=(0,a.createClient)(),{data:r,error:s}=await t.from("admin_questions").select("test_number").eq("category",e);if(s)throw s;return[...new Set((r||[]).map(e=>e.test_number))].length},staleTime:6e5,enabled:r&&!!e})}function d(e){return(0,t.useQuery)({queryKey:["weak-topics",e],queryFn:async()=>{let t=(0,a.createClient)(),{data:r,error:s}=await t.from("test_attempts").select("id").eq("user_id",e).order("completed_at",{ascending:!1}).limit(50);if(s)throw s;let i=(r||[]).map(e=>e.id);if(0===i.length)return{topics:[],weakTopics:[],dominantCategory:null};let{data:n,error:o}=await t.from("test_attempt_answers").select("question_id, is_correct").in("test_attempt_id",i);if(o)throw o;if(!n||0===n.length)return{topics:[],weakTopics:[],dominantCategory:null};let u=[...new Set(n.map(e=>e.question_id))],{data:c,error:l}=await t.from("admin_questions").select("id, topic, category").in("id",u);if(l)throw l;let d=new Map;(c||[]).forEach(e=>{d.set(e.id,{topic:e.topic??null,category:e.category??null})});let h={};n.forEach(e=>{let t=d.get(e.question_id);if(!t||!t.topic)return;let r=t.topic;h[r]||(h[r]={total:0,correct:0,category:t.category}),h[r].total+=1,e.is_correct&&(h[r].correct+=1)});let p=Object.entries(h).map(([e,t])=>{let r=t.total>0?t.correct/t.total:0;return{topic:e,totalQuestions:t.total,correct:t.correct,accuracy:r}}).sort((e,t)=>e.accuracy-t.accuracy),y=p.filter(e=>e.totalQuestions>=3&&e.accuracy<.8).slice(0,5),m={};y.forEach(e=>{let t=h[e.topic]?.category;t&&(m[t]=(m[t]||0)+1)});let _=null,f=0;if(Object.entries(m).forEach(([e,t])=>{t>f&&(f=t,_=e)}),!_&&p.length>0){let e={};Object.values(h).forEach(t=>{t.category&&(e[t.category]=(e[t.category]||0)+1)});let t=0;Object.entries(e).forEach(([e,r])=>{r>t&&(t=r,_=e)})}return{topics:p,weakTopics:y,dominantCategory:_}},enabled:!!e,staleTime:12e4})}e.s(["useClearAllTestAttempts",()=>c,"useDashboardStats",()=>n,"useDeleteTestAttempt",()=>u,"useGlobalDailyStreak",()=>i,"useTestCount",()=>l,"useTestHistory",()=>o,"useWeakTopics",()=>d])},32106,41173,e=>{"use strict";var t=e.i(39898);let r=(0,t.default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);e.s(["Target",()=>r],32106);let s=(0,t.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);e.s(["Activity",()=>s],41173)},79850,e=>{"use strict";let t=(0,e.i(39898).default)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);e.s(["Brain",()=>t],79850)}]);